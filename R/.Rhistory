coord_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_mapping_files.txt"
clin_file <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/thrane_clinical.csv"
thrane <- STList(countfiles=count_files, coordfiles=coord_files, clinical=clin_file)
thrane <- STList_new(countfiles=count_files, coordfiles=coord_files, clinical=clin_file)
count_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_count_files.txt"
coord_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_mapping_files.txt"
clin_file <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/thrane_clinical.csv"
thrane <- STList(count_files=count_files, coord_files=coord_files, clin_file=clin_file)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
count_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_count_files.txt"
coord_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_mapping_files.txt"
clin_file <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/thrane_clinical.csv"
thrane <- STList(counts=count_files, coords=coord_files, samplefile=clin_file)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
count_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_count_files.txt"
coord_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_mapping_files.txt"
clin_file <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/thrane_clinical.csv"
thrane <- STList(countfiles=count_files, coordfiles=coord_files, clinical=clin_file)
thrane <- voom_norm(thrane)
thrane <- spatial_deconv(thrane, method='xcell')
gene_names <- c('PMEL', 'SPP1', 'CD74', 'IGLL5', 'SOX10', 'SOX4')
plist0 <- plot_gene_quilt(thrane, genes=gene_names, plot_who=2, visium=F)
plist0[[4]] + theme_void() + ggtitle('') + theme(legend.position='none')
#pdf(file='./quilt_without_purity_WORKFLOWPANEL.pdf')
plist0[[4]] + theme_void() + ggtitle('') + theme(legend.position='none')
#dev.off()
gene_names <- c('PMEL', 'SPP1', 'CD74', 'IGLL5', 'SOX10', 'SOX4')
thrane <- gene_krige(thrane, genes=gene_names, univ=F, res=0.2)
cell_names <- c('b_cells')
thrane <- deconv_krige(thrane, cells=cell_names, univ=F)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
count_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_count_files.txt"
coord_files <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/fpaths_mapping_files.txt"
clin_file <- "~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGE_thrane_example_data_set_COMPLETE/thrane_clinical.csv"
thrane <- STList(countfiles=count_files, coordfiles=coord_files, clinical=clin_file)
thrane <- voom_norm(thrane)
thrane <- spatial_deconv(thrane, method='xcell')
plist0_1 <- plot_gene_quilt(thrane, genes='SPP1', plot_who=2, visium=F)
plist0_1 + theme_void() + ggtitle('') + theme(legend.position='none')
plist0_1[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
gene_names <- c('PMEL', 'SPP1', 'CD74', 'IGLL5', 'SOX10', 'SOX4')
plist1 <- plot_gene_quilt(thrane, genes=gene_names, plot_who=2, visium=F, purity=T)
plist1[[7]] + theme_void() + ggtitle('') + theme(legend.position='none')
#pdf(file='./quiltBW_with_purity_WORKFLOWPANEL.pdf')
plist1[[7]] + theme_void() + ggtitle('') + theme(legend.position='none')
#dev.off()
gene_names <- c('PMEL', 'SPP1', 'CD74', 'IGLL5', 'SOX10', 'SOX4')
thrane <- gene_krige(thrane, genes=gene_names, univ=F, res=0.2)
gene_names <- c('PMEL', 'SPP1', 'CD74', 'IGLL5', 'SOX10', 'SOX4')
plist2 <- plot_gene_krige(thrane, genes=gene_names, krige_type='ord', plot_who=2, visium=F)
plist2_1 <- plot_gene_krige(thrane, genes='SPP1', krige_type='ord', plot_who=2, visium=F)
plist2_1[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
gene_krige
View(gene_krige)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
thrane <- gene_krige_py(thrane, genes=gene_names, univ=F, res=0.2)
plist2 <- plot_gene_krige(thrane, genes=gene_names, krige_type='ord', plot_who=2, visium=F)
thrane@gene_krige=list()
thrane <- gene_krige_py(thrane, genes=gene_names, univ=F, res=0.2)
gene_names <- c('PMEL', 'SPP1', 'CD74', 'IGLL5', 'SOX10', 'SOX4')
plist2 <- plot_gene_krige(thrane, genes=gene_names, krige_type='ord', plot_who=2, visium=F)
plist2_1 <- plot_gene_krige(thrane, genes='SPP1', krige_type='ord', plot_who=2, visium=F)
plist2_1[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
View(plist2)
plist2[[2]] + theme_void() + ggtitle('') + theme(legend.position='none')
plist2_1[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
plist2[[2]] + theme_void() + ggtitle('') + theme(legend.position='none')
cell_names <- c('b_cells')
thrane <- deconv_krige(thrane, cells=cell_names, univ=F)
cell_names <- c('b_cells')
plist3 <- plot_deconv_krige(thrane, cells=cell_names, krige_type='ord', visium=F)
plist3[[2]] + theme_void() + ggtitle('') + theme(legend.position='none')
#pdf(file='./cell_kriging_without_purity_without_pvals_WORKFLOWPANEL.pdf')
plist3[[2]] + theme_void() + ggtitle('') + theme(legend.position='none')
#dev.off()
thrane <- cluster_STspot(thrane, weights=0.075)
plist4 <- plot_STclusters(thrane, plot_who=2, visium=F)
plist4[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
#pdf(file='./clusterplot_without_purity_WORKFLOWPANEL.pdf')
plist4[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
#dev.off()
genes_plot <- c()
for(i in 1:length(thrane@counts)){
ordered_genes <-
thrane@gene_stdev[[i]]$gene[order(thrane@gene_stdev[[i]]$gene_stdevs, decreasing=T)]
genes_plot <- append(
genes_plot, ordered_genes[1:10])
genes_plot <- append(
genes_plot, ordered_genes[(length(ordered_genes)-9) : length(ordered_genes)])
}
genes_plot <- append(genes_plot, c('PMEL', 'SPP1', 'CD74', 'IGLL5', 'SOX10', 'SOX4'))
genes_plot <- genes_plot[!duplicated(genes_plot)]
i=2
#for(i in 1:length(thrane@counts)){
thrane <- gene_moran_I(thrane, genes=genes_plot, subj=i)
thrane <- gene_geary_C(thrane, genes=genes_plot, subj=i)
thrane <- gene_getis_Gi(thrane, genes=genes_plot, subj=i)
#}
spat_stats <- c()
for(i in 1:length(thrane@counts)){
stdevs <- thrane@gene_stdev[[i]][(thrane@gene_stdev[[i]]$gene %in% genes_plot), c('gene', 'gene_stdevs')]
gene_stats_df <- tibble::tibble()
genes_in_subj <- genes_plot[(genes_plot %in% thrane@gene_stdev[[i]]$gene)]
for(gene in genes_in_subj){
moran <- thrane@gene_het[[gene]][[i]]$morans_I$estimate[[1]]
geary <- thrane@gene_het[[gene]][[i]]$gearys_C$estimate[[1]]
getis <- thrane@gene_het[[gene]][[i]]$getis_ord_Gi$estimate[[1]]
gene_stats <- tibble::tibble_row(gene=gene,
moran=as.double(moran),
geary=as.double(geary),
getis=as.double(getis))
gene_stats_df <- dplyr::bind_rows(gene_stats_df, gene_stats)
}
spat_stats[[i]] <- dplyr::full_join(stdevs, gene_stats_df, by='gene')
}
spat_stats <- c()
for(i in 1:length(thrane@counts)){
stdevs <- thrane@gene_stdev[[i]][(thrane@gene_stdev[[i]]$gene %in% genes_plot), c('gene', 'gene_stdevs')]
gene_stats_df <- tibble::tibble()
genes_in_subj <- genes_plot[(genes_plot %in% thrane@gene_stdev[[i]]$gene)]
for(gene in genes_in_subj){
moran <- thrane@gene_het[[gene]][[i]]$morans_I$estimate[[1]]
geary <- thrane@gene_het[[gene]][[i]]$gearys_C$estimate[[1]]
getis <- thrane@gene_het[[gene]][[i]]$getis_ord_Gi$estimate[[1]]
gene_stats <- tibble::tibble_row(gene=gene,
moran=as.double(moran),
geary=as.double(geary),
getis=as.double(getis))
gene_stats_df <- dplyr::bind_rows(gene_stats_df, gene_stats)
}
spat_stats[[i]] <- dplyr::full_join(stdevs, gene_stats_df, by='gene')
}
#i=2
for(i in 1:length(thrane@counts)){
thrane <- gene_moran_I(thrane, genes=genes_plot, subj=i)
thrane <- gene_geary_C(thrane, genes=genes_plot, subj=i)
thrane <- gene_getis_Gi(thrane, genes=genes_plot, subj=i)
}
spat_stats <- c()
for(i in 1:length(thrane@counts)){
stdevs <- thrane@gene_stdev[[i]][(thrane@gene_stdev[[i]]$gene %in% genes_plot), c('gene', 'gene_stdevs')]
gene_stats_df <- tibble::tibble()
genes_in_subj <- genes_plot[(genes_plot %in% thrane@gene_stdev[[i]]$gene)]
for(gene in genes_in_subj){
moran <- thrane@gene_het[[gene]][[i]]$morans_I$estimate[[1]]
geary <- thrane@gene_het[[gene]][[i]]$gearys_C$estimate[[1]]
getis <- thrane@gene_het[[gene]][[i]]$getis_ord_Gi$estimate[[1]]
gene_stats <- tibble::tibble_row(gene=gene,
moran=as.double(moran),
geary=as.double(geary),
getis=as.double(getis))
gene_stats_df <- dplyr::bind_rows(gene_stats_df, gene_stats)
}
spat_stats[[i]] <- dplyr::full_join(stdevs, gene_stats_df, by='gene')
}
mod_clinical <- thrane@clinical
mod_clinical[['survival_months']] <- thrane@clinical$Survival %>%
gsub("days|\\+ years", "", .) %>%
gsub("10", "3650", .) %>%
as.numeric()
mod_clinical$survival_months <- mod_clinical$survival_months/30
thrane@clinical <- tibble::as_tibble(mod_clinical)
mod_clinical <- thrane@clinical
mod_clinical[['subj']] <- thrane@clinical$sampleID %>%
gsub("[A-Z]", "", .) %>%
as.factor()
thrane@clinical <- tibble::as_tibble(mod_clinical)
gene <- 'SPP1'
moran <- c()
geary <- c()
getis <- c()
for(i in 1:length(thrane@gene_het[[gene]])){
moran <- append(moran,
thrane@gene_het[[gene]][[i]]$morans_I$estimate[[1]])
geary <- append(geary,
thrane@gene_het[[gene]][[i]]$gearys_C$estimate[[1]])
getis <- append(getis,
thrane@gene_het[[gene]][[i]]$getis_ord_Gi$estimate[[1]])
}
df <- dplyr::bind_cols(subj=thrane@clinical$subj,
survival=thrane@clinical$survival_months,
tibble::as_tibble_col(moran, column_name='moran_stat'),
tibble::as_tibble_col(geary, column_name='geary_stat'),
tibble::as_tibble_col(getis, column_name='getis_stat'))
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light()
clinp1
#pdf(file='./clinicalspatial_plot_WORKFLOWPANEL.pdf')
clinp1
#dev.off()
gene <- 'PMEL'
moran <- c()
geary <- c()
getis <- c()
for(i in 1:length(thrane@gene_het[[gene]])){
moran <- append(moran,
thrane@gene_het[[gene]][[i]]$morans_I$estimate[[1]])
geary <- append(geary,
thrane@gene_het[[gene]][[i]]$gearys_C$estimate[[1]])
getis <- append(getis,
thrane@gene_het[[gene]][[i]]$getis_ord_Gi$estimate[[1]])
}
df <- dplyr::bind_cols(subj=thrane@clinical$subj,
survival=thrane@clinical$survival_months,
tibble::as_tibble_col(moran, column_name='moran_stat'),
tibble::as_tibble_col(geary, column_name='geary_stat'),
tibble::as_tibble_col(getis, column_name='getis_stat'))
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light()
clinp1
#pdf(file='./clinicalspatial_plot_WORKFLOWPANEL.pdf')
clinp1
#dev.off()
gene <- 'CD74'
moran <- c()
geary <- c()
getis <- c()
for(i in 1:length(thrane@gene_het[[gene]])){
moran <- append(moran,
thrane@gene_het[[gene]][[i]]$morans_I$estimate[[1]])
geary <- append(geary,
thrane@gene_het[[gene]][[i]]$gearys_C$estimate[[1]])
getis <- append(getis,
thrane@gene_het[[gene]][[i]]$getis_ord_Gi$estimate[[1]])
}
df <- dplyr::bind_cols(subj=thrane@clinical$subj,
survival=thrane@clinical$survival_months,
tibble::as_tibble_col(moran, column_name='moran_stat'),
tibble::as_tibble_col(geary, column_name='geary_stat'),
tibble::as_tibble_col(getis, column_name='getis_stat'))
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light()
clinp1
#pdf(file='./clinicalspatial_plot_WORKFLOWPANEL.pdf')
clinp1
#dev.off()
plist2_2 <- plot_gene_krige(thrane, genes='CD74', krige_type='ord', plot_who=2, visium=F)
plist2_2[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
plist0_2 <- plot_gene_quilt(thrane, genes='CD74', plot_who=2, visium=F)
plist0_2[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
pdf(file='./quilt_without_purity_WORKFLOWPANEL_CD74.pdf')
plist0_2[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
dev.off()
pdf(file='./quilt_without_purity_WORKFLOWPANEL_CD74.pdf')
plist0_2[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
dev.off()
pdf(file='./kriging_without_purity_WORKFLOWPANEL_CD74.pdf')
plist2_2[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
dev.off()
clinp1
pdf(file='./clinicalspatial_plot_WORKFLOWPANEL_CD74.pdf')
clinp1
dev.off()
View(plist1)
plist1_1 <- plot_gene_quilt(thrane, genes='CD74', plot_who=2, visium=F, purity=T)
ggpubr::ggarrange(
plist1_1[[1]],
plist1_1[[2]],
nrow=1, ncol=2, common.legend=T, legend='bottom')
ggpubr::ggarrange(
plist1_1[[1]],
plist1_1[[2]],
nrow=1, ncol=2, common.legend=T, legend='bottom')
pdf(file='./quilt_with_purity_RESULTSPANEL_CD74.pdf')
ggpubr::ggarrange(
plist1_1[[1]],
plist1_1[[2]],
nrow=1, ncol=2, common.legend=T, legend='bottom')
dev.off()
plist5_1 <- plot_gene_krige(thrane, genes='CD74', krige_type='ord', plot_who=2, visium=F, purity=T)
pdf(file='./kriging_with_purity_RESULTSPANEL_CD74.pdf')
plist5_1[[1]]
dev.off()
i=2
moran_lm <- lm(spat_stats[[i]]$moran ~ spat_stats[[i]]$gene_stdevs)
spat_stats[[i]] <- spat_stats[[i]] %>% dplyr::mutate(reg_line_moran=predict(moran_lm))
moran_lm_summ <- summary(moran_lm)
moran_rsq <- moran_lm_summ$adj.r.squared
moran_pval <- pf(moran_lm_summ$fstatistic[1], moran_lm_summ$fstatistic[2],
moran_lm_summ$fstatistic[3], lower.tail = FALSE)
geary_lm <- lm(spat_stats[[i]]$geary ~ spat_stats[[i]]$gene_stdevs)
spat_stats[[i]] <- spat_stats[[i]] %>% dplyr::mutate(reg_line_geary=predict(geary_lm))
geary_lm_summ <- summary(geary_lm)
geary_rsq <- geary_lm_summ$adj.r.squared
geary_pval <- pf(geary_lm_summ$fstatistic[1], geary_lm_summ$fstatistic[2],
geary_lm_summ$fstatistic[3], lower.tail = FALSE)
getis_lm <- lm(spat_stats[[i]]$getis ~ spat_stats[[i]]$gene_stdevs)
spat_stats[[i]] <- spat_stats[[i]] %>% dplyr::mutate(reg_line_getis=predict(getis_lm))
getis_lm_summ <- summary(getis_lm)
getis_rsq <- getis_lm_summ$adj.r.squared
getis_pval <- pf(getis_lm_summ$fstatistic[1], getis_lm_summ$fstatistic[2],
getis_lm_summ$fstatistic[3], lower.tail = FALSE)
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Moran's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(moran_rsq, 4), "; ",
"pval=", round(moran_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_moran)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
p2 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=geary, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Geary's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(geary_rsq, 4), "; ",
"pval=", round(geary_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_geary)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
p3 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=getis, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Getis-Ord Gi I vs. standard dev - subj ", i, "\n",
"r_adj=", round(getis_rsq, 4), "; ",
"pval=", round(getis_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_getis)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=getis), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#pdf(file="spatial_stats_RESULTSPANEL.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#dev.off()
pdf(file="spatial_stats_RESULTSPANEL_CD74HIGH.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
dev.off()
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
xlim
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
xlim
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Moran's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(moran_rsq, 4), "; ",
"pval=", round(moran_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_moran)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
p2 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=geary, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Geary's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(geary_rsq, 4), "; ",
"pval=", round(geary_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_geary)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
p3 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=getis, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Getis-Ord Gi I vs. standard dev - subj ", i, "\n",
"r_adj=", round(getis_rsq, 4), "; ",
"pval=", round(getis_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_getis)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=getis), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#pdf(file="spatial_stats_RESULTSPANEL.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#dev.off()
pdf(file="spatial_stats_RESULTSPANEL_CD74HIGH.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
dev.off()
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Moran's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(moran_rsq, 4), "; ",
"pval=", round(moran_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_moran)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
p2 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=geary, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Geary's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(geary_rsq, 4), "; ",
"pval=", round(geary_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_geary)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
p3 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=getis, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Getis-Ord Gi I vs. standard dev - subj ", i, "\n",
"r_adj=", round(getis_rsq, 4), "; ",
"pval=", round(getis_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_getis)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=getis), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=getis), color='#E34D34', size=3)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#pdf(file="spatial_stats_RESULTSPANEL.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#dev.off()
pdf(file="spatial_stats_RESULTSPANEL_CD74HIGH.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.002)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.00036)
df
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.00036)
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0015)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.00036)
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0015)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.00037)
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0015)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0004)
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
