dev.off()
pdf(file='./kriging_without_purity_WORKFLOWPANEL_CD74.pdf')
plist2_2[[1]] + theme_void() + ggtitle('') + theme(legend.position='none')
dev.off()
clinp1
pdf(file='./clinicalspatial_plot_WORKFLOWPANEL_CD74.pdf')
clinp1
dev.off()
View(plist1)
plist1_1 <- plot_gene_quilt(thrane, genes='CD74', plot_who=2, visium=F, purity=T)
ggpubr::ggarrange(
plist1_1[[1]],
plist1_1[[2]],
nrow=1, ncol=2, common.legend=T, legend='bottom')
ggpubr::ggarrange(
plist1_1[[1]],
plist1_1[[2]],
nrow=1, ncol=2, common.legend=T, legend='bottom')
pdf(file='./quilt_with_purity_RESULTSPANEL_CD74.pdf')
ggpubr::ggarrange(
plist1_1[[1]],
plist1_1[[2]],
nrow=1, ncol=2, common.legend=T, legend='bottom')
dev.off()
plist5_1 <- plot_gene_krige(thrane, genes='CD74', krige_type='ord', plot_who=2, visium=F, purity=T)
pdf(file='./kriging_with_purity_RESULTSPANEL_CD74.pdf')
plist5_1[[1]]
dev.off()
i=2
moran_lm <- lm(spat_stats[[i]]$moran ~ spat_stats[[i]]$gene_stdevs)
spat_stats[[i]] <- spat_stats[[i]] %>% dplyr::mutate(reg_line_moran=predict(moran_lm))
moran_lm_summ <- summary(moran_lm)
moran_rsq <- moran_lm_summ$adj.r.squared
moran_pval <- pf(moran_lm_summ$fstatistic[1], moran_lm_summ$fstatistic[2],
moran_lm_summ$fstatistic[3], lower.tail = FALSE)
geary_lm <- lm(spat_stats[[i]]$geary ~ spat_stats[[i]]$gene_stdevs)
spat_stats[[i]] <- spat_stats[[i]] %>% dplyr::mutate(reg_line_geary=predict(geary_lm))
geary_lm_summ <- summary(geary_lm)
geary_rsq <- geary_lm_summ$adj.r.squared
geary_pval <- pf(geary_lm_summ$fstatistic[1], geary_lm_summ$fstatistic[2],
geary_lm_summ$fstatistic[3], lower.tail = FALSE)
getis_lm <- lm(spat_stats[[i]]$getis ~ spat_stats[[i]]$gene_stdevs)
spat_stats[[i]] <- spat_stats[[i]] %>% dplyr::mutate(reg_line_getis=predict(getis_lm))
getis_lm_summ <- summary(getis_lm)
getis_rsq <- getis_lm_summ$adj.r.squared
getis_pval <- pf(getis_lm_summ$fstatistic[1], getis_lm_summ$fstatistic[2],
getis_lm_summ$fstatistic[3], lower.tail = FALSE)
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Moran's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(moran_rsq, 4), "; ",
"pval=", round(moran_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_moran)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
p2 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=geary, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Geary's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(geary_rsq, 4), "; ",
"pval=", round(geary_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_geary)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
p3 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=getis, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Getis-Ord Gi I vs. standard dev - subj ", i, "\n",
"r_adj=", round(getis_rsq, 4), "; ",
"pval=", round(getis_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_getis)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=getis), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#pdf(file="spatial_stats_RESULTSPANEL.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#dev.off()
pdf(file="spatial_stats_RESULTSPANEL_CD74HIGH.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
dev.off()
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
xlim
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
xlim
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Moran's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(moran_rsq, 4), "; ",
"pval=", round(moran_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_moran)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
p2 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=geary, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Geary's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(geary_rsq, 4), "; ",
"pval=", round(geary_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_geary)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
p3 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=getis, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Getis-Ord Gi I vs. standard dev - subj ", i, "\n",
"r_adj=", round(getis_rsq, 4), "; ",
"pval=", round(getis_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_getis)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=getis), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#pdf(file="spatial_stats_RESULTSPANEL.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#dev.off()
pdf(file="spatial_stats_RESULTSPANEL_CD74HIGH.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
dev.off()
p1 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=moran, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Moran's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(moran_rsq, 4), "; ",
"pval=", round(moran_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_moran)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=moran), color='#E34D34', size=3)
p2 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=geary, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Geary's I vs. standard dev - subj ", i, "\n",
"r_adj=", round(geary_rsq, 4), "; ",
"pval=", round(geary_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_geary)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=geary), color='#E34D34', size=3)
p3 <- ggplot(data=spat_stats[[i]], aes(x=gene_stdevs, y=getis, label=gene)) +
geom_point() +
ggrepel::geom_text_repel(max.overlaps=5) +
ggtitle(paste0("Getis-Ord Gi I vs. standard dev - subj ", i, "\n",
"r_adj=", round(getis_rsq, 4), "; ",
"pval=", round(getis_pval, 4))) +
geom_line(aes(gene_stdevs, reg_line_getis)) +
theme_classic() +
#geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'IGLL5', ], aes(x=gene_stdevs, y=getis), color='#E34D34', size=3)
geom_point(data=spat_stats[[i]][spat_stats[[i]]$gene == 'CD74', ], aes(x=gene_stdevs, y=getis), color='#E34D34', size=3)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#pdf(file="spatial_stats_RESULTSPANEL.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
#dev.off()
pdf(file="spatial_stats_RESULTSPANEL_CD74HIGH.pdf", width=9, height=9)
gridExtra::grid.arrange(p1, p2, p3, ncol=2, nrow=2)
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.002)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.00036)
df
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.00036)
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0015)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.00036)
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0015)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.00037)
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
clinp1 <- ggplot(df, aes(x=moran_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0016)
clinp2 <- ggplot(df, aes(x=geary_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0015)
clinp3 <- ggplot(df, aes(x=getis_stat, y=survival, color=subj)) +
geom_point() + theme_light() + coord_fixed(ratio=0.0004)
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
pdf(file='./clinicalspatial_plots_RESULTSPANEL_CD74STATS.pdf')
ggpubr::ggarrange(
clinp1,
clinp2,
clinp3,
ncol=3, nrow=1, common.legend=T, legend='bottom')
dev.off()
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/show.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/detect_input_new.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/STList_NEW.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/import_visium_NEW.R')
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/dfs.RData')
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/list_dfs.RData')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/show.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/detect_input.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/STList.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/import_visium.R')
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/dfs.RData')
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/list_dfs.RData')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/utils.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/detect_input.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/STList.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/import_visium.R')
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/dfs.RData')
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/list_dfs.RData')
# Data frames.
exampleSTList = STList_new(rnacounts=counts_df, spotcoords=coords_df)
# Data frames.
exampleSTList = STList(rnacounts=counts_df, spotcoords=coords_df)
# List, no samplefile
exampleSTList = STList(rnacounts=counts_named, spotcoords=coords_named)
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/utils.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/detect_input.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/STList.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/import_visium.R')
# List, no samplefile
exampleSTList = STList(rnacounts=counts_named, spotcoords=coords_named)
View(exampleSTList)
exampleSTList
View(coords_Unnamed)
View(coords_named)
View(counts_named)
View(coords_named)
exampleSTList = STList(rnacounts=counts_Unnamed, spotcoords=coords_Unnamed)
exampleSTList
dim(exampleSTList)
traceback()
length(exampleSTList@counts)
base::dim(object@counts[[1]])
base::dim(exampleSTList@counts[[1]])
for(i in 1:length(object@counts)){
dim_res[[i]] = base::dim(exampleSTList@counts[[i]])
}
for(i in 1:length(exampleSTList@counts)){
dim_res[[i]] = base::dim(exampleSTList@counts[[i]])
}
for(i in 1:length(object@counts)){
print(base::dim(exampleSTList@counts[[i]]))
}
for(i in 1:length(exampleSTList@counts)){
print(base::dim(exampleSTList@counts[[i]]))
}
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/utils.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefMethods.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/utils.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/detect_input.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/STList.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/import_visium.R')
exampleSTList
sim(exampleSTList)
dim(exampleSTList)
is(exampleSTList, Class)
is(exampleSTList, 'STList')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefMethods.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/utils.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/detect_input.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/STList.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/import_visium.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefMethods.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/detect_input.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/STList.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/import_visium.R')
dim(valueClass)
is(exampleSTList, STList)
is(exampleSTList, 'STList')
show
showMethods("show")
show
showMethods("show", classes = 'STList')
showMethods("dim", classes = 'STList')
showMethods("dim")
?standardGeneric
object=exampleSTList
function(object){
if(length(object@counts == 1)){
dim_res = base::dim(object@counts[[1]])
} else{
dim_res = list()
for(i in 1:length(object@counts)){
dim_res[[i]] = base::dim(object@counts[[i]])
}
}
return(dim_res)
}
setMethod("dim", signature="STList",
function(object){
if(length(object@counts == 1)){
dim_res = base::dim(object@counts[[1]])
} else{
dim_res = list()
for(i in 1:length(object@counts)){
dim_res[[i]] = base::dim(object@counts[[i]])
}
}
return(dim_res)
}
)
?setClass
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefMethods.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/detect_input.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/STList.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/import_visium.R')
# List, no samplefile
exampleSTList = STList(rnacounts=counts_named, spotcoords=coords_named)
exampleSTList
sim(exampleSTList)
dim(exampleSTList)
getClass('STList')
summary(exampleSTList)
getClass('Seurat')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
dim(exampleSTList)
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
?setMethod
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
dim(exampleSTList)
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
summary(exampleSTList)
# List, no samplefile
exampleSTList = STList(rnacounts=counts_named, spotcoords=coords_named)
exampleSTList
# List with csv samplefile.
exampleSTList = STList(rnacounts=counts_named, spotcoords=coords_named, samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_matrices.csv')
exampleSTList
# List with tsv samplefile.
exampleSTList = STList(rnacounts=counts_named, spotcoords=coords_named, samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_matrices.txt')
exampleSTList
exampleSTList = STList_new(rnacounts=rna_fp, spotcoords=coord_fp, samples=c('ST_mel1_rep1', 'ST_mel1_rep2', 'ST_mel2_rep1', 'ST_mel2_rep2'))
exampleSTList = STList(rnacounts=rna_fp, spotcoords=coord_fp, samples=c('ST_mel1_rep1', 'ST_mel1_rep2', 'ST_mel2_rep1', 'ST_mel2_rep2'))
rna_fp = c('/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel1_rep1_counts_dedup_genes.tsv',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel1_rep2_counts_dedup_genes.tsv',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel2_rep1_counts_dedup_genes.tsv',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel2_rep2_counts_dedup_genes.tsv')
coord_fp = c('/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel1_rep1_counts_mapping.txt',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel1_rep2_counts_mapping.txt',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel2_rep1_counts_mapping.txt',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel2_rep2_counts_mapping.txt')
exampleSTList = STList(rnacounts=rna_fp, spotcoords=coord_fp, samples=c('ST_mel1_rep1', 'ST_mel1_rep2', 'ST_mel2_rep1', 'ST_mel2_rep2'))
rm(object)
View(exampleSTList)
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R/classDefinitions.R')
View(exampleSTList)
# Vector with several filepaths csv, samplefile (required).
rna_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_dedup_genes.tsv')
coord_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_mapping.txt')
exampleSTList = STList_new(rnacounts=rna_fp, spotcoords=coord_fp, samples='~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/samplesfile_matrices.csv')
# Vector with several filepaths csv, samplefile (required).
rna_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_dedup_genes.tsv')
coord_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_mapping.txt')
exampleSTList = STList(rnacounts=rna_fp, spotcoords=coord_fp, samples='~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/samplesfile_matrices.csv')
# Vector with several filepaths csv, samplefile (required).
rna_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_dedup_genes.tsv')
coord_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_mapping.txt')
exampleSTList = STList(rnacounts=rna_fp, spotcoords=coord_fp, samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_matrices.csv')
# Vector with several filepaths csv, samplefile (required).
rna_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_dedup_genes.tsv')
coord_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_mapping.txt')
exampleSTList = STList(rnacounts=rna_fp, spotcoords=coord_fp, samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_matrices.csv')
traceback()
# Vector with several filepaths csv, samplefile (required).
rna_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_dedup_genes.tsv',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_dedup_genes.tsv')
coord_fp = c('~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel1_rep2_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep1_counts_mapping.txt',
'~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/ST_mel2_rep2_counts_mapping.txt')
exampleSTList = STList(rnacounts=rna_fp, spotcoords=coord_fp, samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_matrices.csv')
detect_input(rnacounts=rna_fp, spotcoords=coord_fp, samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_matrices.csv')
# Vector with several filepaths csv, samplefile (required).
rna_fp = c('/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel1_rep1_counts_dedup_genes.tsv',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel1_rep2_counts_dedup_genes.tsv',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel2_rep1_counts_dedup_genes.tsv',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel2_rep2_counts_dedup_genes.tsv')
coord_fp = c('/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel1_rep1_counts_mapping.txt',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel1_rep2_counts_mapping.txt',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel2_rep1_counts_mapping.txt',
'/Users/4472525/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/inst/extdata/ST_mel2_rep2_counts_mapping.txt')
exampleSTList = STList(rnacounts=rna_fp, spotcoords=coord_fp, samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_matrices.csv')
View(exampleSTList)
# File paths within samplefile only.
exampleSTList = STList_new(samples='~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/samplesfile_matrices.csv')
# File paths within samplefile only.
exampleSTList = STList(samples='~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/samplesfile_matrices.csv')
# File paths within samplefile only.
exampleSTList = STList(samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_matrices.csv')
exampleSTList
rna_fp = c('/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_data_InnaSmalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample12_LMM_B4_ManualAlignmt',
'/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_data_InnaSmalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample3_LMM_A3_ManualAlignmt/sample3_LMM_A3_ManualAlignmt/outs',
'/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_datasets_10X/Human_Ovarian_Cancer_WholeTranscriptomeAnalysis_Extracted')
exampleSTList = STList_new(rnacounts=rna_fp, samples=c('sample12_LMM_B4', 'Human_Ovarian', 'sample3_LMM_A3'))
rna_fp = c('/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_data_InnaSmalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample12_LMM_B4_ManualAlignmt',
'/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_data_InnaSmalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample3_LMM_A3_ManualAlignmt/sample3_LMM_A3_ManualAlignmt/outs',
'/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_datasets_10X/Human_Ovarian_Cancer_WholeTranscriptomeAnalysis_Extracted')
exampleSTList = STList(rnacounts=rna_fp, samples=c('sample12_LMM_B4', 'Human_Ovarian', 'sample3_LMM_A3'))
exampleSTList
rna_fp = c('/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_data_InnaSmalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample12_LMM_B4_ManualAlignmt',
'/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_data_InnaSmalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample3_LMM_A3_ManualAlignmt/sample3_LMM_A3_ManualAlignmt/outs',
'/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_datasets_10X/Human_Ovarian_Cancer_WholeTranscriptomeAnalysis_Extracted')
exampleSTList = STList(rnacounts=rna_fp, samples='~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/samplesfile_visium.tsv')
rna_fp = c('/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_data_InnaSmalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample12_LMM_B4_ManualAlignmt',
'/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_data_InnaSmalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample3_LMM_A3_ManualAlignmt/sample3_LMM_A3_ManualAlignmt/outs',
'/Users/4472525/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_datasets_10X/Human_Ovarian_Cancer_WholeTranscriptomeAnalysis_Extracted')
exampleSTList = STList(rnacounts=rna_fp, samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_visium.tsv')
exampleSTList
# Visium samplefile only.
exampleSTList = STList_new(samples='~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/samplesfile_visium.csv')
# Visium samplefile only.
exampleSTList = STList(samples='~/Dropbox (Moffitt Cancer Center)/TEMP/detect_input_tests/samplesfile_visium.csv')
# Visium samplefile only.
exampleSTList = STList(samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_visium.csv')
# Visium samplefile only.
exampleSTList = STList(samples='~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/detect_input_tests/samplesfile_visium.csv')
