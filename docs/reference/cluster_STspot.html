<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>cluster_STspot: Detect clusters on ST arrays — cluster_STspot • spatialGE</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="cluster_STspot: Detect clusters on ST arrays — cluster_STspot" />
<meta property="og:description" content="Perform unsupervised spatially-informed clustering on the spots of an
spatial array." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialGE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/melanoma_ST_vignette.html">spatialGE: Visualization and spatial heterogeneity analysis of melanoma</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>cluster_STspot: Detect clusters on ST arrays</h1>
    
    <div class="hidden name"><code>cluster_STspot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform unsupervised spatially-informed clustering on the spots of an
spatial array.</p>
    </div>

    <pre class="usage"><span class='fu'>cluster_STspot</span><span class='op'>(</span>
  x <span class='op'>=</span> <span class='cn'>NULL</span>,
  weights <span class='op'>=</span> <span class='fl'>0.1</span>,
  pcs <span class='op'>=</span> <span class='cn'>NULL</span>,
  vperc <span class='op'>=</span> <span class='cn'>NULL</span>,
  method <span class='op'>=</span> <span class='st'>"ward.D"</span>,
  ks <span class='op'>=</span> <span class='st'>"dtc"</span>,
  spotfilter <span class='op'>=</span> <span class='fl'>0</span>,
  topgenes <span class='op'>=</span> <span class='fl'>2000</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an STList with normalized expression data.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>a double 0-1 indicating the weight to be applied to spatial distances.
Defaults to w=0.1.</p></td>
    </tr>
    <tr>
      <th>pcs</th>
      <td><p>the number of principal components (PCs) to retain.</p></td>
    </tr>
    <tr>
      <th>vperc</th>
      <td><p>the minimum percentage of explained variance explained by the PCs to
decide how many of them to retain.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>the linkage method applied to hierarchical clustering. It is passed
to <code>hclust</code> and defaults to 'ward.D'.</p></td>
    </tr>
    <tr>
      <th>ks</th>
      <td><p>the range of k values to assess. Defaults to <code>dtc</code>, meaning <code>cutreeDynamic</code>
is applied.</p></td>
    </tr>
    <tr>
      <th>spotfilter</th>
      <td><p>the number of genes with more than zero counts for a spot to be
included in the clustering analysis. The lower this number, the slower the analysis. If
spotfilter=0, all spots are retained.</p></td>
    </tr>
    <tr>
      <th>topgenes</th>
      <td><p>the number of high spot-to-spot standard deviation to retain before PCA.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>x, the STList with cluster assignments.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function takes an STList and performs PCA on the gene expression data, then
calculates euclidean distances of the PCs and spatial distances. Weighted averages
between the two distances are calculated to perform hierarchical clustering. The
user can define how much weight the spatial distance should have (values
between 0.05 to 0.25 work reasonably well). The method aims to detect compartments
within a tissue.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># In this example, melanoma is an STList.</span>
<span class='co'># Using Dynamic Tree Cuts:</span>
<span class='va'>melanoma</span> <span class='op'>&lt;-</span> <span class='fu'>cluster_STspot</span><span class='op'>(</span><span class='va'>melanoma</span>, ks<span class='op'>=</span><span class='st'>'dtc'</span>, weights<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: magrittr</span></div><div class='output co'>#&gt; <span class='error'>Error in cluster_STspot(melanoma, ks = "dtc", weights = 0.1): object 'melanoma' not found</span></div><div class='input'>
<span class='co'># Using a range of ks:</span>
<span class='va'>melanoma</span> <span class='op'>&lt;-</span> <span class='fu'>cluster_STspot</span><span class='op'>(</span><span class='va'>melanoma</span>, ks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>)</span>, weights<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in cluster_STspot(melanoma, ks = c(2:6), weights = 0.1): object 'melanoma' not found</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Oscar Ospina, Brooke Fridley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


