melanoma <- spatialTransform(melanoma)
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'SOX10'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'MLANA'), visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F, color_pal='discrete rainbow')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F, color_pal='muted')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
khroma::info()
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F, color_pal='BuRd')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F, color_pal='BuRd', ptsize=2)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F,
color_pal='BuRd', ptsize=2, data_type = 'raw')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F,
color_pal='BuRd', ptsize=2)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
melanoma <- gene_krige(melanoma, genes=c('CD19', 'MLANA'), who=c(2, 3), python=F)
kriges1 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, legend='bottom')
View(krige_geor)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- gene_krige(melanoma, genes=c('CD19', 'MLANA'), who=c(2, 3), python=F, res=0.2)
kriges1 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, legend='bottom')
kriges1 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F,
color_pal='BuRd')
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, legend='bottom')
kriges2 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=3, visium=F)
ggpubr::ggarrange(plotlist=kriges2, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatial_xcell)
?capture.output
?invisible
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatialDeconv)
View(spatial_xcell)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatial_xcell)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
?suppressMessages
View(spatialDeconv)
View(spatial_xcell)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatial_xcell)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatial_xcell)
invisible(capture.output(x=1))
invisible(capture.output(x <- 1))
x
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(melanoma)
View(spatial_xcell)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2,
purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=F, visium=F)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=F, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(quilts2)
quilts2[["b_cells_ST_mel1_rep2"]]
quilts2[["i_dc_ST_mel1_rep2"]]
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(plot_deconv_quilt)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F, ptsize = 2)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(plot_gene_krige)
View(quilt_p)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F, ptsize = 2)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(quilt_p)
View(quilt_p_purity)
View(quilt_p_purity_bw)
View(plot_deconv_quilt)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=F, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(plot_deconv_quilt)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
melanoma@cell_deconv$xCell$ST_mel1_rep1$cell_var
order(melanoma@cell_deconv$xCell$ST_mel1_rep1$cell_var$cell_stdevs, decreasing = T)
melanoma@cell_deconv$xCell$ST_mel1_rep1$cell_var$cell[order(melanoma@cell_deconv$xCell$ST_mel1_rep1$cell_var$cell_stdevs, decreasing = T)]
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'preadipocytes'), plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'fibroblasts'), plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'melanocytes'), plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
visiumfp <- c('~/Desktop/Visium_FFPE_Human_Normal_Prostate/',
'~/Desktop/Visium_FFPE_Human_Prostate_Cancer/',
'~/Desktop/Visium_FFPE_Human_Prostate_Acinar_Cell_Carcinoma/')
visiumIDs <- c('Normal_Prostate',
'Prostate_Cancer',
'Prostate_Acinar_Cell')
prvisium <- STList(rnacounts=visiumfp, samples=visiumIDs)
devtools::install_github("fridleylab/spatialGE", ref='oscar_dev')
devtools::install_github("fridleylab/spatialGE", ref='oscar_dev')
install.packages('terra')
library('spatialGE')
prvisium <- STList(rnacounts=visiumfp, samples=visiumIDs)
plot_gene_quilt(prvisium, gene='KLK3', image = T)
plot_gene_quilt(prvisium, gene='KLK3', image = T, data_type = 'raw')
test= plot_gene_quilt(prvisium, gene='KLK3', image = T, data_type = 'raw')
ggpubr::ggarrange(plotlist = test, ncol=2, nrow=3)
prvisium
prvisium <- spatialTransform(prvisium)
qplot <- plot_gene_quilt(prvisium, genes='KLK3', color_pal='sunset', image=T)
ggpubr::ggarrange(plotlist=qplot, ncol=2, nrow=2)
ggpubr::ggarrange(plotlist=qplot, ncol=2, nrow=3)
prvisium <- gene_krige(prvisium, genes='KLK3', univ=F, python=T)
kplot <- plot_gene_krige(prvisium, genes='KLK3', color_pal='sunset', image=T)
ggpubr::ggarrange(plotlist=kplot, ncol=2, nrow=3, legend='bottom')
prvisium <- spatialDeconv(prvisium, method="none")
eplot <- plot_gene_quilt(prvisium, genes="KLK3", color_pal="sunset", purity=T, image=T, ptsize=1)
ggpubr::ggarrange(plotlist=eplot, ncol=3, nrow=2, legend='bottom')
ggpubr::ggarrange(plotlist=eplot, ncol=3, nrow=3, legend='bottom')
library('spatialGE')
?spatialGE::STList
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
if("devtools" %in% rownames(installed.packages()) == FALSE) {
install.packages("devtools")
}
# devtools::install_github("fridleylab/spatialGE")
library('spatialGE')
dcc_files =  "~/Desktop/geomx_input/Kidney_Dataset/dccs"
pkc = '~/Desktop/geomx_input/Kidney_Dataset/pkcs/TAP_H_WTA_v1.0.pkc'
sample_annots = "~/Desktop/geomx_input/Kidney_Sample_Annotations.txt"
slide_col="SlideName"
id_col="Sample_ID"
x_col="ROICoordinateX"
y_col="ROICoordinateY"
meta_cols=c('disease_status',	'pathology', 'region')
kdgeomx <- STList(rnacounts=dcc_files, gmx_pkc=pkc, samples=sample_annots,
gmx_slide_col=slide_col,
gmx_roi_col=id_col,
gmx_x_col=x_col,
gmx_y_col=y_col,
gmx_meta_cols=meta_cols)
kdgeomx
x=kdgeomx
images='~/Desktop/geomx_input/images/'
imageFps = list.files(images, full.names=T)
imageFps
source('~/Desktop/load_images.R')
rm(x)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
if("devtools" %in% rownames(installed.packages()) == FALSE) {
install.packages("devtools")
}
# devtools::install_github("fridleylab/spatialGE")
library('spatialGE')
dcc_files =  "~/Desktop/geomx_input/Kidney_Dataset/dccs"
pkc = '~/Desktop/geomx_input/Kidney_Dataset/pkcs/TAP_H_WTA_v1.0.pkc'
sample_annots = "~/Desktop/geomx_input/Kidney_Sample_Annotations.txt"
slide_col="SlideName"
id_col="Sample_ID"
x_col="ROICoordinateX"
y_col="ROICoordinateY"
meta_cols=c('disease_status',	'pathology', 'region')
kdgeomx <- STList(rnacounts=dcc_files, gmx_pkc=pkc, samples=sample_annots,
gmx_slide_col=slide_col,
gmx_roi_col=id_col,
gmx_x_col=x_col,
gmx_y_col=y_col,
gmx_meta_cols=meta_cols)
kdgeomx
source('~/Desktop/load_images.R')
images = '~/Desktop/geomx_input/images/'
kdgeomx = load_images(kdgeomx, images)
plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1)
plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1, 'MYC')
plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1, genes = 'MYC')
??png::readPNG
kdgeomx@misc$sp_images[[1]]
View(kdgeomx@misc$sp_images[[1]])
View(kdgeomx)
library("EBImage")
install.packages('EBImage')
BiocManager::install("EBImage")
install.packages('EBImage')
library("EBImage")
test = resize(kdgeomx@misc$sp_images$disease3, w=200, h=100)
test
kdgeomx@misc$sp_images$disease3 = test
kdgeomx
p= plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1, genes = 'MYC')
p$imagedisease3
dim(kdgeomx@misc$sp_images[[1]])
dim(kdgeomx@misc$sp_images[[2]])
dim(kdgeomx@misc$sp_images[[1]])[1]
dim(kdgeomx@misc$sp_images[[1]])[2]
any(dim(kdgeomx@misc$sp_images[[1]])) > 500
any(dim(kdgeomx@misc$sp_images[[1]])) > 50
any(dim(kdgeomx@misc$sp_images[[1]]) > 50)
any(dim(kdgeomx@misc$sp_images[[1]]) > 500)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
if("devtools" %in% rownames(installed.packages()) == FALSE) {
install.packages("devtools")
}
# devtools::install_github("fridleylab/spatialGE")
library('spatialGE')
dcc_files =  "~/Desktop/geomx_input/Kidney_Dataset/dccs"
pkc = '~/Desktop/geomx_input/Kidney_Dataset/pkcs/TAP_H_WTA_v1.0.pkc'
sample_annots = "~/Desktop/geomx_input/Kidney_Sample_Annotations.txt"
slide_col="SlideName"
id_col="Sample_ID"
x_col="ROICoordinateX"
y_col="ROICoordinateY"
meta_cols=c('disease_status',	'pathology', 'region')
kdgeomx <- STList(rnacounts=dcc_files, gmx_pkc=pkc, samples=sample_annots,
gmx_slide_col=slide_col,
gmx_roi_col=id_col,
gmx_x_col=x_col,
gmx_y_col=y_col,
gmx_meta_cols=meta_cols)
kdgeomx
images = '~/Desktop/geomx_input/images/'
kdgeomx = load_images(kdgeomx, images)
source('~/Desktop/load_images.R')
images = '~/Desktop/geomx_input/images/'
kdgeomx = load_images(kdgeomx, images)
p= plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1, genes = 'MYC')
p
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
if("devtools" %in% rownames(installed.packages()) == FALSE) {
install.packages("devtools")
}
# devtools::install_github("fridleylab/spatialGE")
library('spatialGE')
dcc_files =  "~/Desktop/geomx_input/Kidney_Dataset/dccs"
pkc = '~/Desktop/geomx_input/Kidney_Dataset/pkcs/TAP_H_WTA_v1.0.pkc'
sample_annots = "~/Desktop/geomx_input/Kidney_Sample_Annotations.txt"
slide_col="SlideName"
id_col="Sample_ID"
x_col="ROICoordinateX"
y_col="ROICoordinateY"
meta_cols=c('disease_status',	'pathology', 'region')
kdgeomx <- STList(rnacounts=dcc_files, gmx_pkc=pkc, samples=sample_annots,
gmx_slide_col=slide_col,
gmx_roi_col=id_col,
gmx_x_col=x_col,
gmx_y_col=y_col,
gmx_meta_cols=meta_cols)
kdgeomx
source('~/Desktop/load_images.R')
images = '~/Desktop/geomx_input/images/'
kdgeomx = load_images(kdgeomx, images)
p= plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1, genes = 'MYC')
p
ggpubr::ggarrange(plotlist = p, ncol=2)
ggpubr::ggarrange(plotlist = p, ncol=2, visium=T)
p= plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1, genes = 'MYC', visium = T)
ggpubr::ggarrange(plotlist = p, ncol=2, visium=T)
ggpubr::ggarrange(plotlist = p, ncol=2)
p= plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1, genes = 'MYC', visium = F)
ggpubr::ggarrange(plotlist = p, ncol=2)
p= plot_gene_quilt(kdgeomx, data_type = 'raw', image = T, plot_who = 1, genes = 'LACTB', visium = F)
ggpubr::ggarrange(plotlist = p, ncol=2)
qplot <- plot_gene_quilt(kdgeomx, image=T, genes='TXNIP', visium=F)
kdgeomx <- spatialTransform(kdgeomx)
View(kdgeomx)
kdgeomx@counts[["disease3"]][1:5, 1:5]
kdgeomx <- spatialTransform(kdgeomx)
remove.packages("spatialGE")
devtools::load_all('../')
data_files <- system.file("extdata", package="spatialGE")
count_files <- list.files(data_files, full.names=T, pattern='counts')
coord_files <- list.files(data_files, full.names=T, pattern='mapping')
clin_file <- list.files(data_files, full.names=T, pattern='clinical')
melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
melanoma
bulk_pca(melanoma, clinvar='gender')
melanoma <- spatialTransform(melanoma)
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F,
color_pal='BuRd', ptsize=2)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
melanoma <- gene_krige(melanoma, genes=c('CD19', 'MLANA'), who=c(2, 3), python=F,
res=0.2)
kriges1 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, legend='bottom')
kriges2 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=3, visium=F)
ggpubr::ggarrange(plotlist=kriges2, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- spatialDeconv(melanoma, method='xcell')
quilts2 <- plot_deconv_quilt(melanoma, cells='b_cells', plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=2, legend='bottom')
quilts3 <- plot_gene_quilt(melanoma, genes='CD74', plot_who=2, purity=T, visium=F,
inter=T)
quilts3[[1]]
melanoma <- deconv_krige(melanoma, cells='b_cells', who=2, python=F, res=0.2)
kriges3 <- plot_deconv_krige(melanoma,  cells='b_cells', plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=1, legend='bottom')
kriges4 <- plot_deconv_krige(melanoma,  cells='b_cells', plot_who=2, pvalues=T,
visium=F)
ggpubr::ggarrange(plotlist=kriges4, nrow=1, ncol=1, legend='bottom')
kriges5 <- plot_deconv_krige(melanoma,  cells='b_cells', plot_who=2, purity=T,
visium=F)
ggpubr::ggarrange(plotlist=kriges5, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- STclust(melanoma, ks='dtc', weights=c(0, 0.025, 0.05, 0.075))
cluster_p <- plot_STclusters(melanoma, plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, legend='right')
melanoma <- spatial_stat_plot(melanoma, samplevar='survival_months', gene='CD74')
sphet_info <- tibble::tibble("Low"=c('Dispersion', 'Clustering', '"Cold spots"'),
"Statistic"=c('Moran’s I', 'Geary’s C', 'Getis-Ord Gi'),
"High"=c('Clustering', 'Dispersion', '“Hot spots”')
)
kableExtra::kbl(sphet_info, align='c', caption='Heterogeneity statitstics in `spatialGE`') %>%
kableExtra::kable_styling(position="center", full_width=F)
sessionInfo()
devtools::load_all('../')
dcc_files =  "~/Desktop/geomx_input/Kidney_Dataset/dccs"
pkc = '~/Desktop/geomx_input/Kidney_Dataset/pkcs/TAP_H_WTA_v1.0.pkc'
sample_annots = "~/Desktop/geomx_input/Kidney_Sample_Annotations.txt"
slide_col="SlideName"
id_col="Sample_ID"
x_col="ROICoordinateX"
y_col="ROICoordinateY"
meta_cols=c('disease_status',	'pathology', 'region')
kdgeomx <- STList(rnacounts=dcc_files, gmx_pkc=pkc, samples=sample_annots,
gmx_slide_col=slide_col,
gmx_roi_col=id_col,
gmx_x_col=x_col,
gmx_y_col=y_col,
gmx_meta_cols=meta_cols)
kdgeomx <- STList(rnacounts=dcc_files, gmx_pkc=pkc, samples=sample_annots,
gmx_slide_col=slide_col,
gmx_roi_col=id_col,
gmx_x_col=x_col,
gmx_y_col=y_col,
gmx_meta_cols=meta_cols)
devtools::load_all('../')
install.packages('rjson')
visiumfp <- c('~/Desktop/Visium_FFPE_Human_Normal_Prostate/',
'~/Desktop/Visium_FFPE_Human_Prostate_Cancer/',
'~/Desktop/Visium_FFPE_Human_Prostate_Acinar_Cell_Carcinoma/')
visiumIDs <- c('Normal_Prostate',
'Prostate_Cancer',
'Prostate_Acinar_Cell')
prvisium <- STList(rnacounts=visiumfp, samples=visiumIDs)
devtools::load_all('../')
prvisium <- STList(rnacounts=visiumfp, samples=visiumIDs)
prvisium <- STList(rnacounts=visiumfp[1], samples=visiumIDs[1])
install.packages('R.utils')
prvisium <- STList(rnacounts=visiumfp[1], samples=visiumIDs[1])
devtools::load_all('./')
visiumfp <- c('~/Desktop/Visium_FFPE_Human_Normal_Prostate/',
'~/Desktop/Visium_FFPE_Human_Prostate_Cancer/',
'~/Desktop/Visium_FFPE_Human_Prostate_Acinar_Cell_Carcinoma/')
visiumIDs <- c('Normal_Prostate',
'Prostate_Cancer',
'Prostate_Acinar_Cell')
prvisium <- STList(rnacounts=visiumfp, samples=visiumIDs)
prvisium
library('SeuratData')
options(timeout=600) # Allows time for R to download data
InstallData("stxBrain")
library('SeuratData')
options(timeout=600) # Allows time for R to download data
InstallData("stxBrain")
brain_anterior <- LoadData("stxBrain", type="anterior1")
brain_posterior <- LoadData("stxBrain", type="posterior1")
brain_merge <- merge(brain_anterior, brain_posterior)
brain_STList <- STList(brain_merge)
brain_STList
brain_STList = spatialTransform(brain_STList)
brain_p = spatialGE::plot_gene_quilt(brain_STList, gene='Hpca', image=T, color_pal='sunset')
ggpubr::ggarrange(plotlist=brain_p, ncol=2, nrow=2)
qcplots1 = plot_QC_stats(prvisium, qc='total_reads')
qcplots1
qcplots2 = plot_QC_stats(prvisium, qc='total_genes')
qcplots2
qcplots3 = plot_QC_quilt(prvisium, nreads=T)
ggpubr::ggarrange(plotlist=qcplots3, ncol=3, nrow=1, legend='bottom')
prvisium = filter_data(prvisium, spot_minreads=200, spot_maxreads=50000)
prvisium <- spatialTransform(prvisium)
qcplots4 = plot_QC_quilt(prvisium, nreads=T)
ggpubr::ggarrange(plotlist=qcplots4, ncol=3, nrow=1, legend='bottom')
ggpubr::ggarrange(plotlist=qcplots4, ncol=3, nrow=1, legend='bottom')
qplot <- plot_gene_quilt(prvisium, genes='KLK3', color_pal='sunset', image=T)
ggpubr::ggarrange(plotlist=qplot, ncol=2, nrow=3)
prvisium <- gene_krige(prvisium, genes='KLK3', univ=F, python=T)
kplot <- plot_gene_krige(prvisium, genes='KLK3', color_pal='sunset', image=T)
ggpubr::ggarrange(plotlist=kplot, ncol=2, nrow=3)
devtools::load_all('../')
visiumfp <- c('~/Desktop/Visium_FFPE_Human_Normal_Prostate/',
'~/Desktop/Visium_FFPE_Human_Prostate_Cancer/',
'~/Desktop/Visium_FFPE_Human_Prostate_Acinar_Cell_Carcinoma/')
visiumIDs <- c('Normal_Prostate',
'Prostate_Cancer',
'Prostate_Acinar_Cell')
prvisium <- STList(rnacounts=visiumfp, samples=visiumIDs)
brain_STList = spatialTransform(brain_STList)
prvisium = filter_data(prvisium, spot_maxreads=50000)
qcplots4 = plot_QC_quilt(prvisium, nreads=T)
ggpubr::ggarrange(plotlist=qcplots4, ncol=3, nrow=1, legend='bottom')
prvisium <- spatialTransform(prvisium)
prvisium <- gene_krige(prvisium, genes='KLK3', univ=F, python=T)
kplot <- plot_gene_krige(prvisium, genes='KLK3', color_pal='sunset', image=T)
ggpubr::ggarrange(plotlist=kplot, ncol=2, nrow=3)
prvisium <- spatialDeconv(prvisium, method="none")
eplot <- plot_gene_quilt(prvisium, genes="KLK3", color_pal="sunset", purity=T, image=T, ptsize=1)
ggpubr::ggarrange(plotlist=eplot, ncol=3, nrow=3, legend='bottom')
devtools::load_all('../')
dcc_files =  "~/Desktop/geomx_input/Kidney_Dataset/dccs"
pkc = '~/Desktop/geomx_input/Kidney_Dataset/pkcs/TAP_H_WTA_v1.0.pkc'
sample_annots = "~/Desktop/geomx_input/Kidney_Sample_Annotations.txt"
slide_col="SlideName"
id_col="Sample_ID"
x_col="ROICoordinateX"
y_col="ROICoordinateY"
meta_cols=c('disease_status',	'pathology', 'region')
kdgeomx <- STList(rnacounts=dcc_files, gmx_pkc=pkc, samples=sample_annots,
gmx_slide_col=slide_col,
gmx_roi_col=id_col,
gmx_x_col=x_col,
gmx_y_col=y_col,
gmx_meta_cols=meta_cols)
kdgeomx
images = '~/Desktop/geomx_input/images/'
kdgeomx = load_images(kdgeomx, images)
kdgeomx <- spatialTransform(kdgeomx)
qplot <- plot_gene_quilt(kdgeomx, image=T, genes='TXNIP', visium=F, color_pal='sunset', ptsize=2)
qplot <- plot_gene_quilt(kdgeomx, image=T, genes='TXNIP', visium=F, color_pal='sunset', ptsize=2)
ggpubr::ggarrange(plotlist=qplot, ncol=2, nrow=7)
