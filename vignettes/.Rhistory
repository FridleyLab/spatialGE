fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
max(melanoma@st_clusters$clust_dfs[[1]]$WCluster)
factor(melanoma@st_clusters$clust_dfs[[1]]$WCluster)
levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster)
max(levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
p_palette(max(levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster)))
muted(max(levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster)))
khroma::muted(max(levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster)))
khroma::colour('muted')(max(levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster)))
khroma::colour('muted')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
melanoma@st_clusters$clust_dfs[[1]]
melanoma@st_clusters$clust_dfs[[1]]$WCluster
levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster)
max(levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster))
as.numeric(max(levels(melanoma@st_clusters$clust_dfs[[1]]$WCluster)))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
melanoma@st_clusters$clust_dfs[[1]]
melanoma@st_clusters$clust_dfs[[1]][complete.cases(melanoma@st_clusters$clust_dfs[[1]]), ]
melanoma@st_clusters$clust_dfs[[1]][!complete.cases(melanoma@st_clusters$clust_dfs[[1]]), ]
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
complete.cases(melanoma@st_clusters$clust_dfs[[1]]$WCluster)
View(quilt_p)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
khroma::colour(color_pal)
khroma::colour('muted')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
?scale_color_manual
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
complete.cases(melanoma@st_clusters$clust_dfs[[1]]$WCluster)
melanoma@st_clusters$clust_dfs[[1]][complete.cases(melanoma@st_clusters$clust_dfs[[1]]$WCluster, ]
melanoma@st_clusters$clust_dfs[[1]][complete.cases(melanoma@st_clusters$clust_dfs[[1]]$WCluster), ]
levels(melanoma@st_clusters$clust_dfs[[1]][complete.cases(melanoma@st_clusters$clust_dfs[[1]]$WCluster), ]$WCluster)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
x=melanoma
color_pal='muted'
# Creates color palette function.
p_palette <- khroma::colour(color_pal)
if(is.null(plot_who)){
subjs <- (1:length(x@st_clusters$clust_dfs))
} else{
subjs <- plot_who
}
plot_who=c(1,3)
if(is.null(plot_who)){
subjs <- (1:length(x@st_clusters$clust_dfs))
} else{
subjs <- plot_who
}
i=1
df <- x@st_clusters$clust_dfs[[i]]
nas <- complete.cases(df$WCluster)
df_nonas <- df[nas, ]
df_nas <- df[!nas, ]
df_nonas
df_nas
#df$WCluster <- as.factor(tidyr::replace_na(as.vector(df$WCluster), "no_cluster"))
p <- ggplot()
p <- p + geom_point(data=df_nas, aes(x=X3, y=X2), color='gray50', size=0.3, shape=1)
p <- p + geom_point(data=df_nonas, aes(x=X3, y=X2, color=WCluster, shape=EstCluster), size=0.5)
p
p <- p + scale_color_manual(values=p_palette(max(as.numeric(levels(df_nonas$WCluster)))))
p
max(as.numeric(levels(df_nonas$WCluster)))
p_palette(max(as.numeric(levels(df_nonas$WCluster))))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
p_palette(max(as.numeric(levels(df_nonas$WCluster))))
as.vector(p_palette(max(as.numeric(levels(df_nonas$WCluster)))))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
View(cluster_STspot)
melanoma <- cluster_STspot(melanoma, purity=F, ks='dtc')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
melanoma <- cluster_STspot(melanoma, purity=F, ks=c(1,3))
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
#for(i in 1:4){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
#}
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
for(i in 1:4){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
}
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
}
View(melanoma)
View(cluster_p)
names(melanoma@st_clusters$clust_dfs[[1]])
melanoma <- cluster_STspot(melanoma, purity=F, ks='dtc')
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
View(cluster_p)
melanoma <- cluster_STspot(melanoma, purity=F, ks=c(1,3))
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
}
View(df)
View(cluster_p)
View(cluster_p)
melanoma <- cluster_STspot(melanoma, purity=F, ks=c(1,3))
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
View(cluster_p)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
melanoma <- cluster_STspot(melanoma, purity=F, ks=c(1,3))
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
View(cluster_p)
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
}
#::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
melanoma <- cluster_STspot(melanoma, purity=T, ks=c(1,3))
cluster_p <- plot_STclusters(melanoma, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
}
#::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
View(melanoma)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
melanoma <- cluster_STspot(melanoma, ks='dtc')
cluster_p <- plot_STclusters(melanoma, purity=F, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
x@cell_deconv$ESTIMATE[[i]]$purity_clusters
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
cluster_p <- plot_STclusters(melanoma, purity=F, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
melanoma <- cluster_STspot(melanoma, ks=c(1,3))
cluster_p <- plot_STclusters(melanoma, purity=F, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
cluster_p <- plot_STclusters(melanoma, purity=F, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
}
#ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
test <- list()
is.null(test)
rlang::is_empty(test)
View(spatial_purity)
View(spatial_deconv)
is.null(test[['ESTIMATE']])
cluster_p <- plot_STclusters(melanoma, purity=F, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
melanoma <- cluster_STspot(melanoma, ks='dtc', weights=0.1, purity=T)
cluster_p <- plot_STclusters(melanoma, purity=F, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
View(quilt_p)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2)
View(krige_p)
