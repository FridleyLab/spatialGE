fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=c(1,3), purity=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=2, ncol=2)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity=T, saveplot = T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=2)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=3)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=3, common.legend = T)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=3, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=3, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=3, common.legend=T, legend='bottom')
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
who=c(1, 3))
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=2)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges1 <- plot_gene_krige(melanoma, genes=c('CAPG', 'SOX10'), plot_who=1)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges1 <- plot_gene_krige(melanoma, genes=c('CAPG', 'SOX10'), plot_who=1)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges1 <- plot_gene_krige(melanoma, genes=c('CAPG', 'SOX10'), plot_who=1)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=F, legend='bottom')
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity = T)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=F, legend='bottom')
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
who=c(1, 3))
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity = T)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=F, legend='bottom')
melanoma@cell_krige <- list()
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
who=c(1, 3))
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity = T)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=F, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
melanoma <- cluster_STspot(melanoma, ks='dtc', weights=0.1)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity = T)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=F, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity = T)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=F, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
melanoma <- readRDS("~/Desktop/melanoma_shortSTList.RDS")
knitr::opts_chunk$set(
collapse=TRUE,
comment="#>",
fig.width=10, fig.height=7
)
if("devtools" %in% rownames(installed.packages()) == FALSE) {
install.packages("devtools")
}
#devtools::install_github("fridleylab/spatialGEdev")
melanoma
bulk_pca(melanoma, clinvar='Gender')
melanoma <- voom_norm(melanoma)
quilts1 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- gene_krige(melanoma, genes=c('CAPG', 'SOX10'), who=c(1, 3))
kriges1 <- plot_gene_krige(melanoma, genes=c('CAPG', 'SOX10'), plot_who=1)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, common.legend=T, legend='bottom')
sphet_info <- tibble::tibble("Low"=c('Dispersion', 'Clustering', '"Cold spots"'),
"Statistic"=c('Moran’s I', 'Geary’s C', 'Getis-Ord Gi'),
"High"=c('Clustering', 'Dispersion', '“Hot spots”')
)
knitr::kable(sphet_info, align='c', caption='Heterogeneity statitstics in `spatialGE`', format='simple')
kriges2 <- plot_gene_krige(melanoma, genes=c('CAPG', 'SOX10'), plot_who=3)
ggpubr::ggarrange(plotlist=kriges2, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- spatial_deconv(melanoma, method='xcell')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(plot_STclusters)
View(plot_deconv_quilt)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
melanoma@cell_deconv$xCell[[1]]$sqrt_scores$cell_names
melanoma@cell_deconv$xCell[[1]]$cell_stdev
melanoma@cell_deconv$xCell[[1]]$cell_stdev[order(melanoma@cell_deconv$xCell[[1]]$cell_stdev$cell_stdevs, decreasing=T), ]
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells', 'msc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells', 'msc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=2, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells', 'smooth_muscle'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=2, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells', 'preadipocytes'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=2, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells', 'nkt'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=2, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'ly_endothelial_cells', 'fibroblasts'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=2, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'fibroblasts'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=2, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'fibroblasts'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'pericytes'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
view(melanoma@cell_deconv$xCell[[1]]$cell_stdev[order(melanoma@cell_deconv$xCell[[1]]$cell_stdev$cell_stdevs, decreasing=T), ])
View(melanoma@cell_deconv$xCell[[1]]$cell_stdev[order(melanoma@cell_deconv$xCell[[1]]$cell_stdev$cell_stdevs, decreasing=T), ])
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'cd4_tem'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'th2_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'clp'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'hsc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'th1_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'cd8_t_cells'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
View(spatial_xcell)
View(voom_norm)
melanoma@cell_deconv <- list()
melanoma <- spatial_deconv(melanoma, method='xcell')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
melanoma <- spatial_deconv(melanoma, method='xcell')
melanoma@cell_deconv$xCell[[1]
melanoma@cell_deconv$xCell[[1]]$cell_stdev
quilts2 <- plot_deconv_quilt(melanoma, cells='top',
color_pal="YlOrBr", plot_who=1, purity=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
?plot_deconv_quilt
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, purity=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
View(quilt_p_purity)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=F, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts3 <- plot_gene_quilt(melanoma, genes=c('CAPG', 'SOX10'), color_pal="YlOrBr",
plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts3, nrow=1, ncol=3, common.legend=T, legend='bottom')
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
who=c(1, 3))
View(deconv_krige)
melanoma <- deconv_krige(melanoma, cells='top',
who=c(1, 3))
View(deconv_krige)
melanoma@cell_deconv$xCell[[1]]$cell_stdev$cell[order(melanoma@cell_deconv$xCell[[1]]$cell_stdev, decreasing=T)][1:10]
melanoma@cell_deconv$xCell[[1]]$cell_stdev[order(melanoma@cell_deconv$xCell[[1]]$cell_stdev, decreasing=T), 1][1:10]
melanoma@cell_deconv$xCell[[1]]$cell_stdev[order(melanoma@cell_deconv$xCell[[1]]$cell_stdev, decreasing=T)][1:10]
View(melanoma)
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
melanoma <- deconv_krige(melanoma, cells='top',
who=c(1, 3))
melanoma@gene_stdev[[1]]$gene[order(melanoma@gene_stdev[[1]]$gene_stdevs, decreasing=T)][1:10]
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'ly_endothelial_cells'),
who=c(1, 3))
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'a_dc'),
who=c(1, 3))
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges4 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, pvalues=T)
ggpubr::ggarrange(plotlist=kriges4, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc']
melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc', ]
View(melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc', ])
melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc', ] < 0.05
sum(melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc', ] < 0.05)
View(melanoma@cell_deconv$xCell[[1]]$cell_stdev[order(melanoma@cell_deconv$xCell[[1]]$cell_stdev$cell_stdevs, decreasing=T), ])
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'i_dc'),
who=c(1, 3))
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges4 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1, pvalues=T)
ggpubr::ggarrange(plotlist=kriges4, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges5 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=kriges5, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- cluster_STspot(melanoma, ks='dtc', weights=0.1)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=F, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- cluster_STspot(melanoma, ks=c(2:4), weights=0.1)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=F, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
}
#ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2), common.legend=T, legend='bottom')
}
#ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2, common.legend=T, legend='bottom'))
}
#ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
melanoma <- cluster_STspot(melanoma, ks='dtc', weights=0.1)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# In case specific k values are selected:
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2, common.legend=T, legend='bottom'))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# In case specific k values are selected:
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2, common.legend=T, legend='bottom'))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
View(cell_geary_C)
