ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges4 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'a_dc'),
color_pal="YlOrBr", plot_who=1, pvalues=T)
ggpubr::ggarrange(plotlist=kriges4, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc']
melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc', ]
View(melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc', ])
melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc', ] < 0.05
sum(melanoma@cell_deconv$xCell[[1]]$pvals[melanoma@cell_deconv$xCell[[1]]$pvals$cell_names == 'a_dc', ] < 0.05)
View(melanoma@cell_deconv$xCell[[1]]$cell_stdev[order(melanoma@cell_deconv$xCell[[1]]$cell_stdev$cell_stdevs, decreasing=T), ])
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'i_dc'),
who=c(1, 3))
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1)
ggpubr::ggarrange(plotlist=kriges3, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges4 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1, pvalues=T)
ggpubr::ggarrange(plotlist=kriges4, nrow=1, ncol=2, common.legend=T, legend='bottom')
kriges5 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'i_dc'),
color_pal="YlOrBr", plot_who=1, purity=T)
ggpubr::ggarrange(plotlist=kriges5, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- cluster_STspot(melanoma, ks='dtc', weights=0.1)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=F, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
fx_dir <- list.files(path="~/OneDrive - Moffitt Cancer Center/SPATIAL_TRANSCRIPTOMICS/code/spatialGEdev/R",
full.names=T)
fx_dir <- grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source, verbose=F)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- cluster_STspot(melanoma, ks=c(2:4), weights=0.1)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=F, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2))
}
#ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2), common.legend=T, legend='bottom')
}
#ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
for(i in 1:2){
print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2, common.legend=T, legend='bottom'))
}
#ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
melanoma <- cluster_STspot(melanoma, ks='dtc', weights=0.1)
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# In case specific k values are selected:
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2, common.legend=T, legend='bottom'))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=2, ncol=2, common.legend=T, legend='bottom')
cluster_p <- plot_STclusters(melanoma, purity=T, plot_who=c(1,3))
# In case specific k values are selected:
# for(i in 1:2){
#  print(ggpubr::ggarrange(plotlist=cluster_p[[i]], nrow=2, ncol=2, common.legend=T, legend='bottom'))
# }
ggpubr::ggarrange(plotlist=cluster_p, nrow=1, ncol=2, common.legend=T, legend='bottom')
View(cell_geary_C)
if("devtools" %in% rownames(installed.packages()) == FALSE) {
install.packages("devtools")
}
library(spatialGE)
data_files <- system.file("extdata", package="spatialGE")
data_files <- list.files(data_files, full.names=T)
count_files <- grep("genes", data_files, value=T)
coord_files <- grep("mapping", data_files, value=T)
clin_file <- grep("clinical", data_files, value=T)
melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
melanoma
bulk_pca(melanoma, clinvar='gender')
melanoma <- voom_norm(melanoma)
melanoma <- spatial_deconv(melanoma, method='xcell')
kriges5 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'i_dc'), plot_who=2,
purity=T, visium=F)
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'i_dc'), who=2, python=F)
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'i_dc'), who=2, python=F)
melanoma <- deconv_krige(melanoma, cells=c('b_cells', 'i_dc'), who=2, python=T)
kriges3 <- plot_deconv_krige(melanoma,  cells=c('b_cells', 'i_dc'), plot_who=2, visium=F)
remove.packages("spatialGE")
melanoma=readRDS('~/Dropbox (Moffitt Cancer Center)/thrane_melanoma_TMP_object.RDS')
bulk_pca(melanoma, clinvar='gender')
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
bulk_pca(melanoma, clinvar='gender')
View(melanoma)
View(bulk_pca)
tibble::tibble(gene=rownames(melanoma@counts[[1]])
tibble::tibble(gene=rownames(melanoma@counts[[1]]))
rowSums(melanoma@counts[[1]])
x=melanoma
i=1
bulk_expr <- rowSums(x@counts[[i]]) %>%
tibble::as_tibble_col(bulk_expr, column_name=paste0("st_", i)) %>%
tibble::add_column(x@counts[[i]][, 1], .before=1)
bulk_expr <- rowSums(x@counts[[i]]) %>%
tibble::as_tibble_col(., column_name=paste0("st_", i)) %>%
tibble::add_column(x@counts[[i]][, 1], .before=1)
bulk_expr
for(i in 1:length(x@counts)){
bulk_expr <- rowSums(x@counts[[i]]) %>%
tibble::as_tibble_col(., column_name=paste0("st_", i)) %>%
tibble::add_column(x@counts[[i]][, 1], .before=1)
bulkcounts_df <- dplyr::inner_join(bulkcounts_df, bulk_expr, by=c('gene'))
}
# Create data frame to store "bulk counts".
bulkcounts_df <- tibble::tibble(gene=rownames(x@counts[[1]]))
# Loop through count matrices, get gene-wise sums, and collate samples
for(i in 1:length(x@counts)){
bulk_expr <- rowSums(x@counts[[i]]) %>%
tibble::as_tibble_col(., column_name=paste0("st_", i)) %>%
tibble::add_column(x@counts[[i]][, 1], .before=1)
bulkcounts_df <- dplyr::inner_join(bulkcounts_df, bulk_expr, by=c('gene'))
}
# Create data frame to store "bulk counts".
bulkcounts_df <- tibble::tibble(gene=rownames(x@counts[[1]]))
# Loop through count matrices, get gene-wise sums, and collate samples
for(i in 1:length(x@counts)){
bulk_expr <- rowSums(x@counts[[i]]) %>%
tibble::as_tibble_col(., column_name=paste0("st_", i)) %>%
tibble::add_column(gene=rownames(x@counts[[i]]), .before=1)
bulkcounts_df <- dplyr::inner_join(bulkcounts_df, bulk_expr, by=c('gene'))
}
bulkcounts_df
View(spatialTransform)
View(voom_norm)
View(voom_norm)
View(voom_norm)
View(voom_norm)
View(voom_norm)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma=readRDS('~/Dropbox (Moffitt Cancer Center)/thrane_melanoma_TMP_object.RDS')
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
bulk_pca(melanoma, clinvar='gender')
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
View(bulk_pca)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
bulk_pca(melanoma, clinvar='gender')
bulk_pca(melanoma, clinvar='gender', tr_method = 'voom')
bulk_pca(melanoma, clinvar='gender')
bulk_pca(melanoma, clinvar='gender', tr_method = 'voom')
bulk_pca(melanoma, clinvar='gender')
melanoma@clinical
bulk_pca(melanoma, clinvar='survival_months')
bulk_pca(melanoma, clinvar='RIN')
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
rownames(installed.packages())
system.file("extdata", package="spatialGE")
library(spatialGE)
remove.packages("spatialGE")
system.file("extdata", package="spatialGE")
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
data_files = '~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/inst/extdata/'
count_files <- list.files(data_files, full.names=T, pattern='counts')
coord_files <- list.files(data_files, full.names=T, pattern='mapping')
clin_file <- list.files(data_files, full.names=T, pattern='clinical')
count_files
coord_files
clin_file
melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
#melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
melanoma2 <- STList(rnacounts=count_files, spotcoords=coord_files, samples=c('ST_mel2_rep1', 'ST_mel1_rep2'))
#melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
melanoma2 <- STList(rnacounts=count_files, spotcoords=coord_files, samples=c('ST_mel1_rep1', 'ST_mel1_rep2', 'ST_mel2_rep1', 'ST_mel2_rep2', 'ST_mel3_rep1', 'ST_mel3_rep2', 'ST_mel4_rep1', 'ST_mel4_rep2'))
melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
rm(melanoma2)
melanoma
bulk_pca(melanoma, clinvar='gender')
i
rownames(melanoma@counts[[1]])
bulk_pca(melanoma, clinvar='gender')
View(bulk_pca)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
data_files <- system.file("extdata", package="spatialGE")
count_files <- list.files(data_files, full.names=T, pattern='counts')
coord_files <- list.files(data_files, full.names=T, pattern='mapping')
clin_file <- list.files(data_files, full.names=T, pattern='clinical')
melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
count_files
data_files = '~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/inst/extdata/'
count_files <- list.files(data_files, full.names=T, pattern='counts')
coord_files <- list.files(data_files, full.names=T, pattern='mapping')
clin_file <- list.files(data_files, full.names=T, pattern='clinical')
melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
melanoma
bulk_pca(melanoma, clinvar='gender')
?tibble::as_tibble_col
# library(spatialGE)
count_files <- list.files("~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/inst/extdata/", full.names=T, pattern='counts')
coord_files <- list.files("~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/inst/extdata/", full.names=T, pattern='mapping')
clin_file <- "~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/inst/extdata/thrane_clinical.csv"
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
#data_files <- system.file("extdata", package="spatialGE")
data_files = '~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/inst/extdata/'
count_files <- list.files(data_files, full.names=T, pattern='counts')
coord_files <- list.files(data_files, full.names=T, pattern='mapping')
clin_file <- list.files(data_files, full.names=T, pattern='clinical')
melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
melanoma
View(bulk_pca)
x=melanoma
clinvar='gender'
require('magrittr')
require('ggplot2')
if(!is.null(clinvar) && !(clinvar %in% colnames(x@clinical))){
stop('Variable not in sample data. Verify that input matches variable name in sample data')
}
# Test if an STList has been input.
if(is.null(x) | !is(x, 'STList')){
stop("The input must be a STList.")
}
# Stop function if only one sample provided.
if(length(x@counts) < 2){
stop('Refusing to plot a single observation PCA!')
}
# Extract clinical data from specified variable. If none specified, use the
# array IDs from the first column of clinical data.
# Also get labels for PCA points.
if(!is.null(clinvar)){
clinvar_vals <- as.character(x@clinical[[clinvar]])
clinvar_vals <- tibble::as_tibble_col(clinvar_vals, column_name=as.character(clinvar))
pca_labs <- as.character(x@clinical[[1]])
}else{
clinvar <- 'ST_sample'
clinvar_vals = names(x@counts)
clinvar_vals <- tibble::as_tibble_col(clinvar_vals, column_name='ST_sample')
pca_labs = as.character(clinvar_vals[[1]])
}
# Create data frame to store "bulk counts".
bulkcounts_df <- tibble::tibble(gene=rownames(x@counts[[1]]))
bulkcounts_df
bulkcounts_df
rownames(x@counts[[1]])
tibble::tibble(gene=rownames(x@counts[[1]]))
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
#data_files <- system.file("extdata", package="spatialGE")
data_files = '~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/inst/extdata/'
count_files <- list.files(data_files, full.names=T, pattern='counts')
coord_files <- list.files(data_files, full.names=T, pattern='mapping')
clin_file <- list.files(data_files, full.names=T, pattern='clinical')
melanoma <- STList(rnacounts=count_files, spotcoords=coord_files, samples=clin_file)
melanoma
bulk_pca(melanoma, clinvar='gender')
melanoma <- spatialTransform(melanoma)
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'SOX10'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'MLANA'), visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD74', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, common.legend=T, legend='bottom')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F, color_pal='discrete rainbow')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F, color_pal='muted')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
khroma::info()
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F, color_pal='BuRd')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F, color_pal='BuRd', ptsize=2)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F,
color_pal='BuRd', ptsize=2, data_type = 'raw')
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
quilts1 <- plot_gene_quilt(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F,
color_pal='BuRd', ptsize=2)
ggpubr::ggarrange(plotlist=quilts1, nrow=1, ncol=2, legend='bottom')
melanoma <- gene_krige(melanoma, genes=c('CD19', 'MLANA'), who=c(2, 3), python=F)
kriges1 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, legend='bottom')
View(krige_geor)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- gene_krige(melanoma, genes=c('CD19', 'MLANA'), who=c(2, 3), python=F, res=0.2)
kriges1 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F)
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, legend='bottom')
kriges1 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=2, visium=F,
color_pal='BuRd')
ggpubr::ggarrange(plotlist=kriges1, nrow=1, ncol=2, legend='bottom')
kriges2 <- plot_gene_krige(melanoma, genes=c('CD19', 'MLANA'), plot_who=3, visium=F)
ggpubr::ggarrange(plotlist=kriges2, nrow=1, ncol=2, common.legend=T, legend='bottom')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatial_xcell)
?capture.output
?invisible
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatialDeconv)
View(spatial_xcell)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatial_xcell)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
?suppressMessages
View(spatialDeconv)
View(spatial_xcell)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatial_xcell)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(spatial_xcell)
invisible(capture.output(x=1))
invisible(capture.output(x <- 1))
x
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
melanoma <- spatialDeconv(melanoma, method='xcell')
View(melanoma)
View(spatial_xcell)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2,
purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=F, visium=F)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=F, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(quilts2)
quilts2[["b_cells_ST_mel1_rep2"]]
quilts2[["i_dc_ST_mel1_rep2"]]
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(plot_deconv_quilt)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F, ptsize = 2)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(plot_gene_krige)
View(quilt_p)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F, ptsize = 2)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(quilt_p)
View(quilt_p_purity)
View(quilt_p_purity_bw)
View(plot_deconv_quilt)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=F, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
View(plot_deconv_quilt)
# library(spatialGE)
fx_dir = list.files(path="~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/spatialGE/R", full.names=T)
fx_dir = grep(".R$", fx_dir, value=T)
sapply(fx_dir, FUN=source)
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T, visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'i_dc'), plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
melanoma@cell_deconv$xCell$ST_mel1_rep1$cell_var
order(melanoma@cell_deconv$xCell$ST_mel1_rep1$cell_var$cell_stdevs, decreasing = T)
melanoma@cell_deconv$xCell$ST_mel1_rep1$cell_var$cell[order(melanoma@cell_deconv$xCell$ST_mel1_rep1$cell_var$cell_stdevs, decreasing = T)]
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'preadipocytes'), plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'fibroblasts'), plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
quilts2 <- plot_deconv_quilt(melanoma, cells=c('b_cells', 'melanocytes'), plot_who=2, purity=T,
color_pal='BuRd', visium=F)
ggpubr::ggarrange(plotlist=quilts2, nrow=1, ncol=3, common.legend=T, legend='bottom')
