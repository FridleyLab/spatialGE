class(test)
test$sample1_MB14_A
head(test$sample1_MB14_A)
openxlsx::write.xlsx(x = test$sample8_LMM_B3, '~/Desktop/de_genes.xlsx')
install.packages('spatialTIME')
library('Seurat')
tmp = Seurat::Load10X_Spatial("../../visium_lmm_smalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample1_MB14_A_ManualAlignmt/sample1_MB14_A_ManualAlignmt/outs/")
tmp = Seurat::Load10X_Spatial("~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/visium_lmm_smalley/smalley_raw_visium_data/smalley_visium_second_run/smalley_visium_combined1_2_runs_sprangercount/sample1_MB14_A_ManualAlignmt/sample1_MB14_A_ManualAlignmt/outs/")
dim(tmp)
rownames(tmp)
head(duplicated(rownames(tmp)))
sum(duplicated(rownames(tmp)))
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
load('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/normalized_stlist.RData')
pseudobulk_pca_plot(normalized_stlist)
pseudobulk_pca_plot(normalized_stlist, plot_meta = NULL)
pseudb = pseudobulk_samples(normalized_stlist, max_var_genes=3000)
pseudobulk_pca_plot(pseudb)
pseudobulk_pca_plot(pseudb, color_pal = 'Spectral')
View(pseudobulk_pca_plot)
x=pseudb
color_pal='Spectral'
plot_meta=NULL; pcx=1; pcy=2; ptsize=5
# Prepare meta data
meta_df = prepare_pseudobulk_meta(x, plot_meta) %>%
tibble::rownames_to_column('pca_labs')
meta_df
# If no sample metadata column was specified, use 'ST_sample' as generated by `prepare_pseudobulk_meta`
if(is.null(plot_meta)){
plot_meta = 'ST_sample'
}
plot_meta
# Get PCA coordinates and add clinical variable data.
pca_tbl = x@misc[['pbulk_pca']] %>%
tibble::rownames_to_column(var='pca_labs') %>%
dplyr::full_join(meta_df, by='pca_labs')
pca_tbl
# Get number of categories from selected variable.
n_cats <- nlevels(as.factor(pca_tbl[[plot_meta]]))
n_cats
color_parse(color_pal, n_cats=n_cats)
View(color_parse())
View(color_parse)
?RColorBrewer::brewer.pal
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
pseudobulk_pca_plot(pseudb, color_pal = 'Spectral')
x@sample_meta
x@misc$pbulk_pca
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
pseudobulk_pca_plot(pseudb, color_pal = 'Spectral')
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
pseudobulk_pca_plot(pseudb, color_pal = 'Spectral')
pseudobulk_pca_plot(pseudb, color_pal = 'muted')
pseudobulk_pca_plot(pseudb, color_pal = 'muted', pcy=3)
devtools::load_all('~/Downloads/')
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
fps = c('~/Desktop/BALBC_1/',
'~/Desktop/BALBC_2/',
'~/Desktop/NOD_1/',
'~/Desktop/NOD_2/')
write.csv(tibble::tibble(samplename=c('BALBC_1', 'BALBC_2', 'NOD_1', 'NOD_2'),
strain=c('balbc', 'balbc', 'nod', 'nod')),
file='~/Desktop/balbc_nod_meta.csv', row.names=F, quote=F)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
fps = c('~/Desktop/BALBC_1/',
'~/Desktop/BALBC_2/',
'~/Desktop/NOD_1/',
'~/Desktop/NOD_2/')
write.csv(tibble::tibble(samplename=c('BALBC_1', 'BALBC_2', 'NOD_1', 'NOD_2'),
strain=c('balbc', 'balbc', 'nod', 'nod')),
file='~/Desktop/balbc_nod_meta.csv', row.names=F, quote=F)
lacrim = STlist(fps, samples='~/Desktop/balbc_nod_meta.csv')
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
fps = c('~/Desktop/BALBC_1/',
'~/Desktop/BALBC_2/',
'~/Desktop/NOD_1/',
'~/Desktop/NOD_2/')
write.csv(tibble::tibble(samplename=c('BALBC_1', 'BALBC_2', 'NOD_1', 'NOD_2'),
strain=c('balbc', 'balbc', 'nod', 'nod')),
file='~/Desktop/balbc_nod_meta.csv', row.names=F, quote=F)
lacrim = STlist(fps, samples='~/Desktop/balbc_nod_meta.csv')
lacrim = transform_data(lacrim)
ps = STplot(lacrim, genes=c('MLANA', 'NOD1', 'MS4A1'))
View(lacrim)
ps = STplot(lacrim, genes=c('Mlana', 'Nod1', 'Ms4a1'))
ps$Nod1_BALBC_1
ps = STplot(lacrim, genes=c('Mlana', 'Nod1', 'Ms4a1'),ptsize = 3)
ps$Nod1_BALBC_1
ps$Ms4a1_NOD_2
ps$Mlana_NOD_1
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
fps = c('~/OneDrive - Moffitt Cancer Center/markowitz_visium_data_sets/hunter_2021/data/visium_a/',
'~/OneDrive - Moffitt Cancer Center/markowitz_visium_data_sets/hunter_2021/data/visium_a/',
'~/OneDrive - Moffitt Cancer Center/markowitz_visium_data_sets/hunter_2021/data/visium_c/')
hunter = STlist(fps, samples=c('visium_a', 'visium_b', 'visium_c'))
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
fps = c('~/OneDrive - Moffitt Cancer Center/markowitz_visium_data_sets/hunter_2021/data/visium_a/',
'~/OneDrive - Moffitt Cancer Center/markowitz_visium_data_sets/hunter_2021/data/visium_b/',
'~/OneDrive - Moffitt Cancer Center/markowitz_visium_data_sets/hunter_2021/data/visium_c/')
hunter = STlist(fps, samples=c('visium_a', 'visium_b', 'visium_c'))
plot_image(hunter)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
fps = c('~/Desktop/BALBC_1/',
'~/Desktop/BALBC_2/',
'~/Desktop/NOD_1/',
'~/Desktop/NOD_2/')
write.csv(tibble::tibble(samplename=c('BALBC_1', 'BALBC_2', 'NOD_1', 'NOD_2'),
strain=c('balbc', 'balbc', 'nod', 'nod')),
file='~/Desktop/balbc_nod_meta.csv', row.names=F, quote=F)
lacrim = STlist(fps, samples='~/Desktop/balbc_nod_meta.csv')
lacrim = transform_data(lacrim)
ps = STplot(lacrim, genes=c('Mlana', 'Nod1', 'Ms4a1'))
ps
?I
|
test = readRDS('~/Dropbox (Moffitt Cancer Center)/Reinstein MCC/Tsai Repository/all_mcc.rds')
dim(test)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
load('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/____STLISTS/stclust_stlist.RData')
stclust_stlist@spatial_meta[[1]]
STplot(stclust_stlist, samples = 1, plot_meta = 'stclust_spw0_k2')
load('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/____STLISTS/stclust_stlist.RData')
stclust_stlist@spatial_meta[[1]]
#library('tidyverse')
#library('Seurat')
library('STdeconvolve')
stclust_stlist@spatial_meta[[2]]
stclust_stlist@spatial_meta[[3]]
stclust_stlist@spatial_meta[[4]]
stclust_stlist@spatial_meta[[5]]
stclust_stlist@spatial_meta[[6]]
load('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/____STLISTS/spagcn/stclust_stlist.RData')
stclust_stlist@spatial_meta
stclust_stlist@spatial_meta[[1]]
colnames(stclust_stlist@spatial_meta[[1]])
STplot(stclust_stlist, samples = 1, plot_meta = "spagcn_k2.x")
STplot(stclust_stlist, samples = 1, plot_meta = "spagcn_k2")
STplot(stclust_stlist, samples = 1, plot_meta = "spagcn_k2", color_pal='smootrainbow')
STplot(stclust_stlist, samples = 1, plot_meta = "spagcn_k2", color_pal='smoothrainbow')
annot_variables = unique(unlist(lapply(stclust_stlist@spatial_meta, function(i){ var_cols=grep('spagcn_', colnames(i), value=T); return(var_cols) })))
annot_variables
cluster_values = tibble::tibble()
for(i in names(stclust_stlist@spatial_meta)){
for(cl in grep('spagcn_|stclust_', colnames(stclust_stlist@spatial_meta[[i]]), value=T)){
cluster_values = dplyr::bind_rows(cluster_values,
tibble::tibble(cluster=as.character(unique(stclust_stlist@spatial_meta[[i]][[cl]]))) %>%
tibble::add_column(annotation=as.character(cl)))
}}
cluster_values = dplyr::distinct(cluster_values) %>%
dplyr::select(annotation, cluster)
write.table(cluster_values, 'stdiff_annotation_variables_clusters.csv', quote=F, row.names=F, col.names=F, sep=',')
getwd()
annot_variables
ps = STplot(stclust_stlist, plot_meta = annot_variables, ptsize = 2, color_pal = 'smoothrainbow')
names(ps)
grep('sample_093d_', names(ps), value=T)
ps$sample_093d_spagcn_k2.x
ps$sample_093d_spagcn_k2.x
ps$sample_093d_spagcn_k3.x
ps$sample_093d_spagcn_k2
ps$sample_093d_spagcn_k3
ps$sample_120d_spagcn_k2
ps$sample_120d_spagcn_k2
ps$sample_120d_spagcn_k3
ps$sample_120d_spagcn_k4
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
load('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/____STLISTS/spagcn/stclust_stlist.RData')
annot_variables = unique(unlist(lapply(stclust_stlist@spatial_meta, function(i){ var_cols=grep('spagcn_', colnames(i), value=T); return(var_cols) })))
annot_variables
x=stclust_stlist
samples=NULL
genes=NULL
plot_meta=annot_variables
ks='dtc'
ws=NULL
deepSplit=NULL
color_pal=NULL
data_type='tr'
ptsize=2
# Check if data set is Visium to flip y axis (may consider remove this in the future)
visium = F
if(x@misc[['platform']] == 'visium'){
visium = T
}
# Define if expression or metadata is to be plotted
if(!is.null(genes)){
# Set default color if NULL input
if(is.null(color_pal)){
color_pal = 'BuRd'
}
if(is.list(genes)){
plot_list = plot_spatial_geneset(x=x, genes=genes, samples=samples, color_pal=color_pal, visium=visium, ptsize=ptsize)
} else{
plot_list = plot_spatial_expression(x=x, genes=genes, samples=samples, color_pal=color_pal, data_type=data_type, visium=visium, ptsize=ptsize)
}
} else{
plot_list = plot_spatial_meta(x=x, samples=samples, ks=ks, ws=ws, deepSplit=deepSplit, plot_meta=plot_meta, color_pal=color_pal, visium=visium, ptsize=ptsize)
}
plot_list$sample_093d_spagcn_k2.x
plot_list$sample_093d_spagcn_k4.x
# Define which samples to plot
if(is.null(samples)){
samples = names(x@spatial_meta)
} else{
if(is.numeric(samples)){
samples = names(x@spatial_meta)[samples]
}
if(length(grep(paste0(samples, collapse='|'), names(x@spatial_meta))) == 0){
stop('The requested samples are not present in the STList spatial metadata.')
}
}
samples
is.null(plot_meta)
# Define columns to plot
if(is.null(plot_meta)){
plot_meta = grep('^stclust_spw', colnames(x@spatial_meta[[1]]), value=T)
if(!is.null(ws)){
if(any(ws == 0)){ # To avoid zero ('0') matching other weights
ws_tmp = ws[ws != 0]
plot_meta_tmp = grep('stclust_spw0_|stclust_spw0$', plot_meta, value=T)
if(length(ws_tmp) > 0){ # In case there are other ws in addition to '0'
plot_meta = c(plot_meta_tmp,
grep(paste0('stclust_spw', ws_tmp, collapse='|'), plot_meta, value=T))
} else{
plot_meta = plot_meta_tmp
}
rm(ws_tmp, plot_meta_tmp)
} else{
plot_meta = grep(paste0('stclust_spw', ws, collapse='|'), plot_meta, value=T)
}
}
if(ks[1] != 'dtc'){
plot_meta = grep(paste0('_k', ks,'$', collapse='|'), plot_meta, value=T)
} else if(ks[1] == 'dtc'){
if(!is.null(deepSplit)){
plot_meta = grep(paste0('_dspl', stringr::str_to_title(as.character(deepSplit)), '$', collapse='|'), plot_meta, value=T)
} else{
plot_meta = grep('_dspl', plot_meta, value=T)
}
} else{
stop('Specify one or several k values to plot, or use ks=\'dtc\' (default).')
}
}
# Check that the meta data column exists
if(length(grep(paste0('^', plot_meta, '$', collapse='|'),  colnames(x@spatial_meta[[1]]))) == 0){
stop('No metadata column or clustering parameters were specified. Or specified parameters do not exist in metadata.')
}
plot_list = list()
samples
s="sample_093d"
# Extract metadata for specific sample
df_tmp = x@spatial_meta[[s]]
# Define size of points
if(is.null(ptsize)){
ptsize = 0.5
}
plot_meta
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
load('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/____STLISTS/spagcn/stclust_stlist.RData')
annot_variables = unique(unlist(lapply(stclust_stlist@spatial_meta, function(i){ var_cols=grep('spagcn_', colnames(i), value=T); return(var_cols) })))
STplot(stclust_stlist, samples = 1, plot_meta = "spagcn_k2", color_pal='smoothrainbow')
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
load('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/____STLISTS/spagcn/stclust_stlist.RData')
annot_variables = unique(unlist(lapply(stclust_stlist@spatial_meta, function(i){ var_cols=grep('spagcn_', colnames(i), value=T); return(var_cols) })))
ps = STplot(stclust_stlist, samples = 1, plot_meta = "spagcn_k2", color_pal='smoothrainbow')
ps$sample_093d_spagcn_k2
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
load('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/____STLISTS/spagcn/stclust_stlist.RData')
annot_variables = unique(unlist(lapply(stclust_stlist@spatial_meta, function(i){ var_cols=grep('spagcn_', colnames(i), value=T); return(var_cols) })))
ps = STplot(stclust_stlist, samples = 1, plot_meta =annot_variables, color_pal='smoothrainbow')
ps$sample_093d_spagcn_k2.x
ps$sample_093d_spagcn_k5
ps$sample_093d_spagcn_k3_refined
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/stlist_creation_tests/dfs.RData')
View(coords_df)
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/stlist_creation_tests/list_dfs.RData')
readRDS('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/stlist_creation_tests/list_dfs.RData')
load('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/stlist_creation_tests/list_dfs.RData')
source('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/stlist_creation_tests/list_dfs.RData')
readRDS('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/stlist_creation_tests/list_dfs.RData')
readRDS('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/code/stlist_creation_tests/list_dfs.RData')
rm(coords_df)
rm(counts_df)
counts = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_counts.csv')
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_counts.csv')
counts = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_counts.csv'),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_counts.csv'),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_counts.csv')
)
View(counts)
counts$sample120d[1:5, 1:5]
coords = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_coordinates.csv'),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_coordinates.csv'),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_coordinates.csv')
)
coords$sample120d
head(coords$sample120d)
test = STlist(counts, coords)
View(coords)
View(counts)
counts[1:5, 1:5]
counts$sample120d[1:5, 1:5]
head(coords$sample120d)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
test = STlist(counts, coords)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
test = STlist(counts, coords)
pkg_fp = list.files(system.file(package='spatialGE'), full.names=T, pattern='err\\.csv')
pkg_fp
err_db = suppressWarnings(read.csv(pkg_fp, header=F))
err_code='error0002'
str_to_print = err_db[[2]][ err_code[[1]] == err_code ]
str_to_print
err_db
err_code
err_code[[1]] == err_code
counts = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_counts.csv'),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_counts.csv'),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_counts.csv')
)
coords = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_coordinates.csv'),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_coordinates.csv'),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_coordinates.csv')
)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
test = STlist(counts, coords)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
test = STlist(counts, coords)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
test = STlist(counts, coords)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
counts = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_counts.csv', check.names = F),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_counts.csv', check.names = F),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_counts.csv', check.names = F)
)
coords = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_coordinates.csv'),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_coordinates.csv'),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_coordinates.csv')
)
test = STlist(counts, coords)
sampleids = c('sample120d', 'sample396a', 'sample397a')
test = STlist(counts, coords, samples=sampleids)
detect_input(rnacounts=counts, spotcoords=coords, samples=sampleids)
!is.null(names(counts)) && !is.null(names(coords))
!is.null(names(counts)) & !is.null(names(coords))
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
counts = list(
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_counts.csv', check.names = F),
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_counts.csv', check.names = F),
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_counts.csv', check.names = F)
)
coords = list(
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_coordinates.csv'),
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_coordinates.csv'),
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_coordinates.csv')
)
test = STlist(counts, coords)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
counts = list(
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_counts.csv', check.names = F),
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_counts.csv', check.names = F),
read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_counts.csv', check.names = F)
)
coords = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_coordinates.csv'),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_coordinates.csv'),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_coordinates.csv')
)
sampleids = c('sample120d', 'sample396a', 'sample397a')
test = STlist(counts, coords, samples=sampleids)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
counts = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_counts.csv', check.names = F),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_counts.csv', check.names = F),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_counts.csv', check.names = F)
)
coords = list(
sample120d=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_120d_coordinates.csv'),
sample396a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_396a_coordinates.csv'),
sample397a=read.csv('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_text_files/sample_397a_coordinates.csv')
)
sampleids = c('sample120d', 'sample396a', 'sample397a')
test = STlist(counts, coords, samples=sampleids)
View(test)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
counts = c
'~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_h5/sample_093d/',
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
counts = c(
'~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_h5/sample_093d/',
'~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_h5/sample_095b/',
'~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_h5/sample_119c'
)
sampleids = c('sample_093d', 'sample_095b', 'sample_119c')
test = STlist(counts, samples=sampleids)
tibble(samplenames=c('sample_093d', 'sample_095b', 'sample_119c'), testdata=c('A', 'B', 'A'))
data.frame(samplenames=c('sample_093d', 'sample_095b', 'sample_119c'), testdata=c('A', 'B', 'A'))
test_clin = data.frame(samplenames=c('sample_093d', 'sample_095b', 'sample_119c'), testdata=c('A', 'B', 'A'))
test = STlist(counts, samples=test_clin)
test_clin
write.csv(test_clin, '~/Desktop/test_clinical.csv', quote=F, row.names=F)
test_clin
test = STlist(counts, samples='~/Desktop/test_clinical.csv')
is.data.frame(test_clin)
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
test = STlist(counts, samples=test_clin)
test = STlist(counts, samples='~/Desktop/test_clinical.csv')
test
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
fps = c('~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_data_repo_breast_cancer/Human_Breast_Cancer_Block_A_Section_1/',
'~/OneDrive - Moffitt Cancer Center/u01_spatialge_web_shared/data/example_data_sets/visium_data_repo_breast_cancer/Visium_FFPE_Breast_Ductal_Carcinoma/')
samplenames = c('Section_1', 'Ductal')
test = STlist(fps, samples = samplenames)
ps = STplot(test, data_type = 'total_counts')
test@spatial_meta
ps = STplot(test, plot_meta = 'total_counts')
ps$Section_1_total_counts
ps = STplot(test, plot_meta = 'total_counts', txsize=20)
ps$Section_1_total_counts
ps = STplot(test, plot_meta = 'total_counts', txsize=100)
ps$Section_1_total_counts
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
ps = STplot(test, plot_meta = 'total_counts', txsize=100)
ps$Section_1_total_counts
ps = STplot(test, plot_meta = 'total_counts', txsize=1000)
ps$Section_1_total_counts
devtools::load_all('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
ps = STplot(test, plot_meta = 'total_counts', txsize=100)
ps$Section_1_total_counts
ps = STplot(test, plot_meta = 'total_counts')
ps$Section_1_total_counts
ps = STplot(test, plot_meta = 'total_counts', txsize = 20)
ps$Section_1_total_counts
ps = STplot(test, plot_meta = 'total_counts', txsize = 20, ptsize = 3)
ps$Section_1_total_counts
ps$Ductal_total_counts
library('XML')
xmlParse('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
xmlParse('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
xml_ls = xmlParse('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
View(xml_ls)
xml_df = xmlToDataFrame('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
xml_df
xml_df = xmlToDataFrame('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
library('xml2')
xml2 = read_xml('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
xml2
View(xml2)
xml_data = read_xml('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
xml_ls = xmlParse(xml_data)
xml_structure(xml_data)
library('XML')
library('xml2')
xml_data = read_xml('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
xml_find_all(xml_data, 'spectrum')
head(xml_data)
xml_data = read_xml('~/Dropbox (Moffitt Cancer Center)/20230411_Smalley_Slide27213_Lipids.d/20230419_smalley_slide27212_test_withazad.imzML')
head(xml_data)
head(xml_data$node)
head(xml_data$doc)
xml_parsed = xmlParse(xml_data)
head(xml_parsed)
xml_parsed
xml_find_all(xml_data, 'spectrumList')
xml_find_all(xml_data, 'run')
xml_find_all(xml_data, 'mzML')
xml_find_all(xml_data, './/mzML')
xml_find_all(xml_data, './/spectrum')
xml_structure(xml_data)
xml_structure(xml_data)
xml_structure(xml_data)
xml_find_all(xml_data, './/cvList')
xml_find_all(xml_data, './/cv')
library(RaMS)
test = readRDS('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/merkel_cell_tsai/cosmx_smi_merkelcc_tsai/data/raw_counts_all_slides_list.RDS')
test$slide_1[1:5, 1:5]
test$slide_1[1:5, 1:20]
seurattest = readRDS('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/merkel_cell_tsai/cosmx_smi_merkelcc_tsai/data/sct_log_counts_all_slides_merged_umap_results.RDS')
seurattest
seurattest@meta.data[1:5, ]
scttest = SCTransform(seurattest, vars.to.regress = 'neg_prb_perc')
seurattest
test=readRDS("~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/merkel_cell_tsai/geomx_merkelcc_tsai/parse_ROI_annotations/data/cleaned_ROI_annotations.RDS")
test
View(test)
expr_df = read.csv('/Volumes/lab_fridley/spatial_transcriptomics/cosmx_datasets/cosmx_human_pancreas_whole_transcriptome/Pancreas_exprMat_file.csv')
expr_df = read.csv('/Volumes/lab_fridley/spatial_transcriptomics/cosmx_datasets/cosmx_human_pancreas_whole_transcriptome/Pancreas_exprMat_file.csv', sep=',', header = T)
expr_df = data.table::fread('/Volumes/lab_fridley/spatial_transcriptomics/cosmx_datasets/cosmx_human_pancreas_whole_transcriptome/Pancreas_exprMat_file.csv', sep = ',')
View(expr_df)
khroma::color('discreterainbow')(5)
install.packages('packrat')
library('renv')
install.packages("renv")
setwd('~/Dropbox (Moffitt Cancer Center)/SPATIAL_TRANSCRIPTOMICS/spatialGE/')
renv::dependencies('.')
class(renv::dependencies('.'))
renv::dependencies('.') %>% write.csv(., '~/Desktop/spatialge_dependencies.csv', quote=F, row.names = F)
library('magrittr')
renv::dependencies('.') %>% write.csv(., '~/Desktop/spatialge_dependencies.csv', quote=F, row.names = F)
renv::dependencies('/Library/Frameworks/R.framework/Resources/library/Seurat')
